"use strict";window.GIDA=window.GIDA??{},window.GIDA.sliders=window.GIDA.sliders??{},window.GIDA.slider_show=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s="gida-slider-show",i=s+"-frame",n=s+"-slides",o="visible",l="start",a="view",r="pause",c="scroll",d=100,h=t?document.getElementById(t):document.getElementsByClassName(s)[0];if(!h)return;const u=e.effect_type??"slide",m=e.duration_time??8,f=e.transition_time??1,p=e.random_timing??!1;let L=e.background_visible??!0,_=e.side_slide_visible??!1;if(h.style.setProperty("--transition-time",`${f}s`),"scroll"!==u&&(_=!1),_){L=!1;h.querySelector("."+n).style.overflow="visible"}const v=Array.prototype.slice.call(h.querySelectorAll(`.${n} > li`)),y=v.length,g=[];let C=null,S=null;const E=[];function w(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&t(),E.push(A(t))}function T(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):setTimeout(t,0)}function I(){window.addEventListener("resize",(()=>{for(const t of E)t()}),{passive:!0})}function A(t){let e;function s(){e=!1,t()}return()=>{e||(e=!0,requestAnimationFrame(s))}}function b(t){let e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},i=null;return{set:()=>new Promise((n=>{e=n,i=setTimeout((async()=>{i=null,await s(),n()}),t)})),clear:()=>{i&&(clearTimeout(i),i=null,e())}}}function D(t,e,s){new IntersectionObserver((s=>{for(const i of s)t.classList[i.isIntersecting?"add":"remove"](e)}),{rootMargin:`${s}px 0px`}).observe(t),document.addEventListener("visibilitychange",(()=>{if("hidden"!==document.visibilityState){const s=t.getBoundingClientRect(),i=window.innerHeight;(0<s.top&&s.top<i||0<s.bottom&&s.bottom<i)&&t.classList.add(e)}else t.classList.remove(e)}))}class z{static CLS_SCROLL="scroll";static CLS_PRE_DISPLAY="pre-display";static CLS_DISPLAY="display";#t=0;#e=null;#s=null;#i="";constructor(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.#t=e,this.#e=s?R.create(t):null,this.#n(t)?(this.#s=new N(t),this.#i="video"):(this.#s=new P(t),this.#i="image"),t.classList.contains(z.CLS_SCROLL)&&this.#s.getElement().classList.add(z.CLS_SCROLL),t.insertBefore(this.#s.getElement(),t.firstChild);const i=t.querySelector("a")??t;i.insertBefore(this.#s.getElement(),i.firstChild)}getType(){return this.#i}#n(t){if(t.dataset.video)return!0;return null!==t.querySelector(":scope > video, :scope > a > video")}onResize(){return!("video"===this.#i&&!this.#s.onResize())&&(this.#e&&this.#e.onResize(),!0)}onPreDisplay(t,e){const s=this.#t%e===t?"add":"remove";this.#s.getElement().classList[s](z.CLS_PRE_DISPLAY),this.#e&&this.#e.getElement().classList[s](z.CLS_PRE_DISPLAY)}transition(t,e){this.#s.transition(this.#t%e===t,e)}display(t,e){const s=this.#t%e===t?"add":"remove";this.#s.getElement().classList[s](z.CLS_DISPLAY),this.#e&&this.#e.getElement().classList[s](z.CLS_DISPLAY),this.#s.display(this.#t%e===t)}getDuration(t,e,s){return this.#s.getDuration(t,e,s)}}class P{static CLS_PIC=s+"-picture";static CLS_DUAL="dual";static RANDOM_RATE=10;#o=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(P.CLS_PIC);const e=t.querySelectorAll(":scope > img, :scope > a > img");if(e.length)this.#o.appendChild(e[0]),1<e.length&&(this.#o.classList.add(P.CLS_DUAL),this.#o.appendChild(e[1]));else if(t.dataset.img){const e=this.#l(t,{src:"img",srcset:"imgSrcset",sizes:"imgSizes"});if(this.#o.appendChild(e),t.dataset.imgSub){this.#o.classList.add(P.CLS_DUAL);const e=this.#l(t,{src:"imgSub",srcset:"imgSubSrcset",sizes:"imgSubSizes"});this.#o.appendChild(e)}}}#l(t,e){const s=document.createElement("img");s.src=t.dataset[e.src];const i=t.dataset[e.srcset]??null,n=t.dataset[e.sizes]??null;return i&&(s.srcset=i),n&&(s.sizes=n),s}getElement(){return this.#o}transition(t,e){}display(t){}getDuration(t,e,s){if(s){return t*(1+.01*P.RANDOM_RATE*(1-2*Math.random()))}return t}}class N{static CLS_VIDEO=s+"-video";#o=null;#a=null;#r=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(N.CLS_VIDEO);const e=t.querySelectorAll(":scope > video, :scope > a > video");if(1===e.length){const t=e[0];this.#c(t),this.#o.appendChild(t),this.#a=t}else if(t.dataset.video){const e=this.#d(t);this.#c(e),this.#o.appendChild(e),this.#a=e}}#d(t){const e=document.createElement("video"),s=document.createElement("source");return s.setAttribute("src",t.dataset.video),e.appendChild(s),e}#c(t){t.muted=!0,t.playsinline=!0,t.setAttribute("muted",!0),t.setAttribute("playsinline",!0),t.addEventListener("loadedmetadata",(()=>{const e=t.clientWidth/t.clientHeight;this.#r=(0|1e3*e)/1e3}))}getElement(){return this.#o}transition(t,e){t&&(this.#a.setAttribute("autoplay",!0),this.#a.play(),1===e&&this.#a.setAttribute("loop",!0))}display(t){t||(this.#a.pause(),this.#a.currentTime=0)}getDuration(t,e,s){return this.#a.duration-e}onResize(){if(!this.#r)return!1;const t=this.#o.clientWidth/this.#o.clientHeight;return this.#r<t?(this.#a.classList.remove("height"),this.#a.classList.add("width")):(this.#a.classList.remove("width"),this.#a.classList.add("height")),!0}}class R{static CLS_CAP=s+"-caption";static CLS_SUBTITLE="subtitle";static CLS_CIRCLE="circle";static CLS_LINE="line";static create(t){const e=t.querySelector(":scope > div, :scope > a > div");return e?new R(e):null}#o=null;constructor(t){this.#o=t,""===t.className&&(t.classList.add(R.CLS_CAP),t.classList.add(R.CLS_SUBTITLE)),t.classList.contains(R.CLS_LINE)||t.classList.contains(R.CLS_CIRCLE)||t.classList.add(R.CLS_SUBTITLE),t.classList.contains(R.CLS_LINE)&&(t.dataset.caption=R.CLS_LINE),t.classList.contains(R.CLS_CIRCLE)&&(t.dataset.caption=R.CLS_CIRCLE),t.classList.contains(R.CLS_SUBTITLE)&&(t.dataset.caption=R.CLS_SUBTITLE);const e=t.querySelectorAll(":scope > div");for(const t of e)this.#h(t);this.#h(t),this.#u(t)}#h(t){for(const e of Array.from(t.childNodes))if(3===e.nodeType){const t=e.nodeValue.trim();if(""!==t){const s=document.createElement("span");s.appendChild(document.createTextNode(t)),e.parentNode.replaceChild(s,e)}}}#u(t){const e=[];for(const s of Array.from(t.childNodes))if(1===s.nodeType)if("DIV"===s.tagName){if(e.length){const i=document.createElement("div");for(const s of e)i.appendChild(t.removeChild(s));t.insertBefore(i,s),e.length=0}}else e.push(s);if(e.length){const s=document.createElement("div");for(const i of e)s.appendChild(t.removeChild(i));t.appendChild(s)}}getElement(){return this.#o}onResize(){window.innerWidth<600?(this.#o.classList.remove(this.#o.dataset.caption),this.#o.classList.add(R.CLS_SUBTITLE)):(this.#o.classList.remove(R.CLS_SUBTITLE),this.#o.classList.add(this.#o.dataset.caption))}}const B=s+"-backgrounds",x=[];function q(t,e,s){const i=document.createElement("div");i.classList.add(B),e.insertBefore(i,e.firstChild);for(let e=0;e<t;e+=1){const t=s[e],n=document.createElement("div"),o=t.querySelector(":scope img");o&&(n.style.backgroundImage=`url('${o.src}')`),i.appendChild(n),x.push(n)}}function M(t,e){for(let s=0;s<e;s+=1)x[s]&&x[s].classList[s===t?"add":"remove"](o)}const U=s+"-prev",$=s+"-next",O="active",k=32;function V(t,e,s){const n=e.getElementsByClassName(i)[0],o=e.getElementsByClassName(U)[0],l=e.getElementsByClassName($)[0];if(1===t)return o&&(o.style.display="none"),void(l&&(l.style.display="none"));const a=async()=>{await s(null,-1)},r=async()=>{await s(null,1)};o&&o.addEventListener("click",(async()=>{n.dataset.disabled=!0,await a(),n.dataset.disabled=!1})),l&&l.addEventListener("click",(async()=>{n.dataset.disabled=!0,await r(),n.dataset.disabled=!1})),null===window.ontouchstart&&X(n,a,r,o,l)}function X(t,e,s,i,n){const o={prev:null,next:null};let l;t.addEventListener("touchstart",(t=>{l=t.touches[0].pageX})),t.addEventListener("touchmove",(t=>{if(null===l)return;const a=t.changedTouches[0].pageX;l+k<a?(e(),G(t,i,"prev",o),l=null):a<l-k&&(s(),G(t,n,"next",o),l=null)})),t.addEventListener("touchend",(()=>{l=null}))}function G(t,e,s,i){!0===t.cancelable&&t.preventDefault(),e&&(clearTimeout(i[s]),e.classList.add(O),i[s]=setTimeout((()=>{e.classList.remove(O)}),1e3*f/2))}const H=s+"-rivets",Y=s+"-rivet",W=[];function F(e,s,i){if(1===e)return;const n=s.getElementsByClassName(H)[0];if(!n)return;const o=2===e?1:0;for(let s=0;s<e;s+=1){const e=s,l=document.createElement("span");l.id=t+"-rivet-"+e,l.className=Y,l.addEventListener("click",(()=>{i(e,o)})),n.appendChild(l),W.push(l)}}function j(t){for(const t of W)t.classList.remove(o);W[t]&&W[t].classList.add(o)}const J=[];function K(e){if(1!==e)for(let s=0;s<e;s+=1){const e=t+"-"+s;let i=document.querySelector('*[data-id="'+e+'"]');i||(i=document.getElementById(e)),J.push(i)}}function Q(t){for(const t of J)t&&t.classList.remove(o);J[t]&&J[t].classList.add(o)}const Z=s+"-slide-count",tt=s+"-slide-index";let et=[],st=[];function it(t,e){et=e.querySelectorAll("."+Z),st=e.querySelectorAll("."+tt);for(const e of et)e.innerHTML=t;for(const t of st)t.innerHTML=1}function nt(t){for(const e of st)e.innerHTML=t+1}class ot{constructor(t,e,s){this._size=t,this._lis=e,this._time=s;for(let t=0;t<this._size;t+=1)this._lis[t].style.transform="translateX("+(t?100:0)+"%)";setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transition="transform "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.transform=e<=t?"translateX(0%)":"translateX(100%)";await b(1e3*this._time).set()}}class lt{constructor(t,e,s){this._size=t,this._lis=e,this._time=s,this._cur=0,this._curPsd=0,this._doing=!1,this._queue=[];const i=this._calcPosition(0,1);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transform=`translateX(${100*i[t]}%)`}async transition(t,e){if(this._queue.push(((s,i)=>this._doTransition(s,i,t,e))),!this._doing){for(this._doing=!0;this._queue.length;)[this._cur,this._curPsd]=await this._queue.shift()(this._cur,this._curPsd);this._doing=!1}}async _doTransition(t,e,s,i){if(0===i&&t!==s){const e=t<s?s-t:s+this._size-t;i=(s<t?t-s:t+this._size-s)<e?-1:1}let n=this._calcPosition(e,i);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.transition="",this._lis[t].style.transform=`translateX(${100*n[t]}%)`;await b(100).set();let o=0;1===i&&(o=s-t),-1===i&&(o=t-s),o<0&&(o+=this._size);let l=e;for(let t=0;t<o;t+=1)[n,l]=this._shift(n,l,i,this._time/o,this._getTransition(o,t)),await b(Math.floor(1e3*this._time/o)).set();return[s,l]}_getTransition(t,e){if(1===t)return"ease";if(2===t){if(0===e)return"ease-in";if(1===e)return"ease-out"}return"linear"}_shift(t,e,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"ease";const o=this._lis.length;let l=e+s;o-1<l&&(l=0),l<0&&(l=o-1);const a=this._calcPosition(l,s);for(let e=0;e<o;e+=1){const s=1===Math.abs(t[e]-a[e])?`transform ${i}s ${n}`:"";this._lis[e].style.transition=s,this._lis[e].style.transform=`translateX(${100*a[e]}%)`}return[a,l]}_calcPosition(t,e){const s=this._lis.length,i=new Array(s),n=-1!==e?Math.ceil((s-1)/2):Math.floor((s-1)/2),o=s-1-n;for(let e=1;e<=n;e+=1){let n=t+e;s-1<n&&(n-=s),i[n]=e}for(let e=1;e<=o;e+=1){let n=t-e;n<0&&(n+=s),i[n]=-e}return i[t]=0,i}}class at{constructor(t,e,s){this._size=t,this._lis=e,this._time=s;for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=0===t?1:0;setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.transition="opacity "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.opacity=e===t?1:0,this._lis[e].style.pointerEvents=e===t?"auto":"none";await b(1e3*this._time).set()}}const rt=ht();function ct(){ut()||setTimeout(ct,100)}L&&q(y,h,v),rt&&setTimeout(ct,100);const dt=h.getElementsByClassName(i)[0];function ht(){"scroll"===u&&1<y&&y<5&&(mt(),2===y&&mt());const t=h.classList.contains(c);let e=!1;for(let s=0;s<v.length;s+=1){t&&v[s].classList.add(c);const i=new z(v[s],s);"video"===i.getType()&&(e=!0),g.push(i)}switch(w(ut,!0),u){case"slide":default:C=new ot(y,v,f);break;case"scroll":C=new lt(y,v,f);break;case"fade":C=new at(y,v,f)}return e}function ut(){let t=!0;for(const e of g)e.onResize()||(t=!1);return t}function mt(){for(let t=0;t<y;t+=1){const e=v[t],s=e.cloneNode(!0);v.push(s),e.parentNode.appendChild(s)}}0<navigator.maxTouchPoints&&dt.addEventListener("pointerenter",(t=>{const e="mouse"===t.pointerType?"remove":"add";dt.classList[e]("touch")}),{once:!0}),T((()=>{I(),V(y,h,vt),K(y),it(y,h),F(y,h,vt),D(h,a,d),vt(0,0),console.log(`Gida Slider - Show (#${t}): started`),setTimeout((()=>h.classList.add(l)),0)}));let ft=0,pt=null,Lt=0,_t=null;async function vt(t,e){[t,e]=Ct(t,e);const s=window.performance.now();if(0!==e&&s-Lt<1e3*f)return clearTimeout(_t),void(_t=setTimeout((()=>vt(t,e)),1e3*f-(s-Lt)));Lt=s;for(const e of g)e.onPreDisplay(t,y);for(const e of g)e.transition(t,y);M(t,y),Q(t),nt(t),j(t),await C.transition(t,e),S&&S(),ft=t,yt(t)}async function yt(t){for(const e of g)e.display(t,y);if(1===y)return;const e=g[t].getDuration(m,f,p);pt&&pt.clear(),pt=b(Math.ceil(1e3*e),gt),await pt.set()}async function gt(){h.classList.contains(a)&&!h.classList.contains(r)?vt(null,1):b(1e3*m,gt).set()}function Ct(t,e){if(null===t)y-1<(t=ft+e)&&(t=0),t<0&&(t=y-1);else if(0===e&&ft!==t){e=(t<ft?ft-t:ft+y-t)<(ft<t?t-ft:t+y-ft)?-1:1}return[t,e]}const St={move:t=>vt(t,2===y?1:0),next:()=>vt(ft===y-1?0:ft+1,1),prev:()=>vt(0===ft?y-1:ft-1,-1),onTransitionEnd:t=>{S=t}};return window.GIDA.sliders[t]=St,St};
//# sourceMappingURL=show.min.js.map