"use strict";window.GIDA=window.GIDA??{},window.GIDA.sliders=window.GIDA.sliders??{},window.GIDA.slider_show=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s="gida-slider-show",i=s+"-frame",n=s+"-slides",o="visible",l="pre-display",a="display",c="start",r="view",d="pause",u=100,h=t?document.getElementById(t):document.getElementsByClassName(s)[0];if(!h)return;const f=e.effect_type??"slide",m=e.duration_time??8,p=e.transition_time??1,v=e.random_timing??!1;let y=e.background_visible??!0,g=e.side_slide_visible??!1;if("scroll"!==f&&(g=!1),g){y=!1;h.querySelector("."+n).style.overflow="visible"}const _=Array.prototype.slice.call(h.querySelectorAll(`.${n} > li`)),L=_.length,w=[];let b=null,E=null,C=!1;const T=[];function S(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&t(),T.push(q(t))}function A(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):setTimeout(t,0)}function z(){window.addEventListener("resize",(()=>{for(const t of T)t()}),{passive:!0})}function q(t){let e;function s(){e=!1,t()}return()=>{e||(e=!0,requestAnimationFrame(s))}}function D(t){let e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},i=null;return{set:()=>new Promise((n=>{e=n,i=setTimeout((async()=>{i=null,await s(),n()}),t)})),clear:()=>{i&&(clearTimeout(i),i=null,e())}}}function N(t,e,s){new IntersectionObserver((s=>{for(const i of s)t.classList[i.isIntersecting?"add":"remove"](e)}),{rootMargin:`${s}px 0px`}).observe(t),document.addEventListener("visibilitychange",(()=>{if("hidden"!==document.visibilityState){const s=t.getBoundingClientRect(),i=window.innerHeight;(0<s.top&&s.top<i||0<s.bottom&&s.bottom<i)&&t.classList.add(e)}else t.classList.remove(e)}))}const I=s+"-backgrounds",B=[];function M(t,e,s,i){const n=document.createElement("div");n.classList.add(I),e.insertBefore(n,e.firstChild);for(let e=0;e<t;e+=1){const t=s[e],o=document.createElement("div"),l=t.querySelector(":scope img");l&&(o.style.backgroundImage=`url('${l.src}')`,o.style.transitionDuration=2*i+"s"),n.appendChild(o),B.push(o)}}function x(t,e){for(let s=0;s<e;s+=1)B[s]&&B[s].classList[s===t?"add":"remove"](o)}const P=s+"-prev",$=s+"-next",k="active",X=32;function G(t,e,s){const n=e.getElementsByClassName(i)[0],o=e.getElementsByClassName(P)[0],l=e.getElementsByClassName($)[0];if(1===t)return o&&(o.style.display="none"),void(l&&(l.style.display="none"));const a=async()=>{await s(null,-1)},c=async()=>{await s(null,1)};o&&o.addEventListener("click",(async()=>{n.dataset.disabled=!0,await a(),n.dataset.disabled=!1})),l&&l.addEventListener("click",(async()=>{n.dataset.disabled=!0,await c(),n.dataset.disabled=!1})),null===window.ontouchstart&&H(n,a,c,o,l)}function H(t,e,s,i,n){const o={prev:null,next:null};let l;t.addEventListener("touchstart",(t=>{l=t.touches[0].pageX})),t.addEventListener("touchmove",(t=>{if(null===l)return;const a=t.changedTouches[0].pageX;l+X<a?(e(),V(t,i,"prev",o),l=null):a<l-X&&(s(),V(t,n,"next",o),l=null)})),t.addEventListener("touchend",(()=>{l=null}))}function V(t,e,s,i){!0===t.cancelable&&t.preventDefault(),e&&(clearTimeout(i[s]),e.classList.add(k),i[s]=setTimeout((()=>{e.classList.remove(k)}),1e3*p/2))}const R=s+"-rivets",W=s+"-rivet",O=[];function F(e,s,i){if(1===e)return;const n=s.getElementsByClassName(R)[0];if(!n)return;const o=2===e?1:0;for(let s=0;s<e;s+=1){const e=s,l=document.createElement("span");l.id=t+"-rivet-"+e,l.className=W,l.addEventListener("click",(()=>{i(e,o)})),n.appendChild(l),O.push(l)}}function j(t){for(const t of O)t.classList.remove(o);O[t]&&O[t].classList.add(o)}const J=[];function K(e){if(1!==e)for(let s=0;s<e;s+=1){const e=t+"-"+s;let i=document.querySelector('*[data-id="'+e+'"]');i||(i=document.getElementById(e)),J.push(i)}}function Q(t){for(const t of J)t&&t.classList.remove(o);J[t]&&J[t].classList.add(o)}const U=s+"-slide-count",Y=s+"-slide-index";let Z=[],tt=[];function et(t,e){Z=e.querySelectorAll("."+U),tt=e.querySelectorAll("."+Y);for(const e of Z)e.innerHTML=t;for(const t of tt)t.innerHTML=1}function st(t){for(const e of tt)e.innerHTML=t+1}const it=s+"-caption",nt=[];function ot(t,e){const s=t.querySelector(":scope > div, :scope > a > div");if(s){s.style.transitionDuration=e+"s",""===s.className&&(s.classList.add(it),s.classList.add("subtitle")),s.classList.contains("line")||s.classList.contains("circle")||s.classList.add("subtitle"),s.classList.contains("line")&&(s.dataset.caption="line"),s.classList.contains("circle")&&(s.dataset.caption="circle"),s.classList.contains("subtitle")&&(s.dataset.caption="subtitle");const t=s.querySelectorAll(":scope > div");for(const e of t)lt(e);lt(s),at(s)}nt.push(s)}function lt(t){for(let e=0;e<t.childNodes.length;e+=1){const s=t.childNodes[e];if(3===s.nodeType){const t=s.nodeValue.trim();if(""===t)continue;const e=document.createElement("span");e.appendChild(document.createTextNode(t)),s.parentNode.replaceChild(e,s)}}}function at(t){let e=[];const s=Array.from(t.childNodes);for(let i of s)if(1===i.nodeType)if("DIV"===i.tagName){if(e.length){const s=document.createElement("div");for(const i of e)s.appendChild(t.removeChild(i));t.insertBefore(s,i),e.length=0}}else e.push(i);if(e.length){const s=document.createElement("div");for(const i of e)s.appendChild(t.removeChild(i));t.appendChild(s)}}function ct(){if(window.innerWidth<600)for(const t of nt)t&&(t.classList.remove(t.dataset.caption),t.classList.add("subtitle"));else for(const t of nt)t&&(t.classList.remove("subtitle"),t.classList.add(t.dataset.caption))}function rt(t,e){ht(t,e,l)}function ut(t,e){ht(t,e,a)}function ht(t,e,s){for(let i=0;i<nt.length;i+=1)nt[i]&&(i%e===t?nt[i].classList.add(s):nt[i].classList.remove(s))}class ft{constructor(t,e,s){this._size=t,this._sls=e,this._time=s;for(let t=0;t<this._size;t+=1)this._sls[t].style.transform="translateX("+(t?100:0)+"%)";setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._sls[t].style.opacity=1,this._sls[t].style.transition="transform "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._sls[e].style.transform=e<=t?"translateX(0%)":"translateX(100%)";await D(1e3*this._time).set()}}class mt{constructor(t,e,s){this._size=t,this._sls=e,this._time=s,this._cur=0,this._curPsd=0,this._doing=!1,this._queue=[];const i=this._calcPosition(0,1);for(let t=0;t<this._sls.length;t+=1)this._sls[t].style.opacity=1,this._sls[t].style.transform=`translateX(${100*i[t]}%)`}async transition(t,e){if(this._queue.push(((s,i)=>this._doTransition(s,i,t,e))),!this._doing){for(this._doing=!0;this._queue.length;)[this._cur,this._curPsd]=await this._queue.shift()(this._cur,this._curPsd);this._doing=!1}}async _doTransition(t,e,s,i){if(0===i&&t!==s){const e=t<s?s-t:s+this._size-t;i=(s<t?t-s:t+this._size-s)<e?-1:1}let n=this._calcPosition(e,i);for(let t=0;t<this._sls.length;t+=1)this._sls[t].style.transition="",this._sls[t].style.transform=`translateX(${100*n[t]}%)`;await D(100).set();let o=0;1===i&&(o=s-t),-1===i&&(o=t-s),o<0&&(o+=this._size);let l=e;for(let t=0;t<o;t+=1)[n,l]=this._shift(n,l,i,this._time/o,this._getTransition(o,t)),await D(Math.floor(1e3*this._time/o)).set();return[s,l]}_getTransition(t,e){if(1===t)return"ease";if(2===t){if(0===e)return"ease-in";if(1===e)return"ease-out"}return"linear"}_shift(t,e,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"ease";const o=this._sls.length;let l=e+s;o-1<l&&(l=0),l<0&&(l=o-1);const a=this._calcPosition(l,s);for(let e=0;e<o;e+=1){const s=1===Math.abs(t[e]-a[e])?`transform ${i}s ${n}`:"";this._sls[e].style.transition=s,this._sls[e].style.transform=`translateX(${100*a[e]}%)`}return[a,l]}_calcPosition(t,e){const s=this._sls.length,i=new Array(s),n=-1!==e?Math.ceil((s-1)/2):Math.floor((s-1)/2),o=s-1-n;for(let e=1;e<=n;e+=1){let n=t+e;s-1<n&&(n-=s),i[n]=e}for(let e=1;e<=o;e+=1){let n=t-e;n<0&&(n+=s),i[n]=-e}return i[t]=0,i}}class pt{constructor(t,e,s){this._size=t,this._sls=e,this._time=s;for(let t=0;t<this._size;t+=1)this._sls[t].style.opacity=0===t?1:0;setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._sls[t].style.transition="opacity "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._sls[e].style.opacity=e===t?1:0,this._sls[e].style.pointerEvents=e===t?"auto":"none";await D(1e3*this._time).set()}}const vt=s+"-picture",yt="dual",gt="scroll",_t=10;class Lt{constructor(t){const e=document.createElement("div");e.classList.add(vt),t.classList.contains(gt)&&e.classList.add(gt);const s=t.querySelectorAll(":scope > img, :scope > a > img");s.length?(e.appendChild(s[0]),1<s.length&&(e.classList.add(yt),e.appendChild(s[1]))):t.dataset.img&&(e.appendChild(this._createImage(t.dataset.img,t.dataset.imgSrcset??null,t.dataset.imgSizes??null)),t.dataset.imgSub&&(e.classList.add(yt),e.appendChild(this._createImage(t.dataset.imgSub,t.dataset.imgSubSrcset??null,t.dataset.imgSubSizes??null)))),this.p=e}_createImage(t,e,s){const i=document.createElement("img");return i.src=t,e&&(i.srcset=e),s&&(i.sizes=s),i}getElement(){return this.p}transition(t,e){}preDisplay(t){t?this.p.classList.add(l):this.p.classList.remove(l)}display(t){t?this.p.classList.add(a):this.p.classList.remove(a)}getDuration(t,e,s){return s?dt*(1+.01*_t*(1-2*Math.random())):t}}const wt=s+"-video";class bt{constructor(t){const e=document.createElement("div");e.classList.add(wt);const s=t.querySelectorAll(":scope > video, :scope > a > video");if(1===s.length){const t=s[0];this._initializeVideo(t),this.v=e.appendChild(t)}else if(t.dataset.video){const s=document.createElement("video");this._initializeVideo(s),this.v=e.appendChild(s);const i=document.createElement("source");i.setAttribute("src",t.dataset.video),s.appendChild(i)}this.p=e}_initializeVideo(t){t.muted=!0,t.playsinline=!0,t.setAttribute("muted",!0),t.setAttribute("playsinline",!0),t.addEventListener("loadedmetadata",(()=>{const e=t.clientWidth/t.clientHeight;this.ar=(0|1e3*e)/1e3}))}getElement(){return this.p}transition(t,e){t&&(this.v.setAttribute("autoplay",!0),this.v.play(),1===e&&this.v.setAttribute("loop",!0))}preDisplay(t){}display(t){t||(this.v.pause(),this.v.currentTime=0)}getDuration(t,e,s){return this.v.duration-e}onResize(){if(!this.ar)return!1;const t=this.p.clientWidth/this.p.clientHeight;return this.ar<t?(this.v.classList.remove("height"),this.v.classList.add("width")):(this.v.classList.remove("width"),this.v.classList.add("height")),!0}}function Et(){At()||setTimeout(Et,100)}Tt(),y&&M(L,h,_,p),C&&setTimeout(Et,100);const Ct=h.getElementsByClassName(i)[0];function Tt(){"scroll"===f&&1<L&&L<5&&(zt(),2===L&&zt());const t=h.classList.contains(gt);for(const e of _){t&&e.classList.add(gt),e.style.opacity=0,ot(e,p);let s=null;St(e)?(s=new bt(e),C=!0):s=new Lt(e),e.insertBefore(s.getElement(),e.firstChild);const i=e.querySelector("a")??e;i.insertBefore(s.getElement(),i.firstChild),w.push(s)}switch(C&&S(At),S(ct,!0),f){case"slide":default:b=new ft(L,_,p);break;case"scroll":b=new mt(L,_,p);break;case"fade":b=new pt(L,_,p)}}function St(t){if(t.dataset.video)return!0;return 0<t.querySelectorAll(":scope > video, :scope > a > video").length}function At(){let t=!0;for(let e=0;e<L;e+=1){const s=w[e];s instanceof bt&&(s.onResize()||(t=!1))}return t}function zt(){for(let t=0;t<L;t+=1){const e=_[t],s=e.cloneNode(!0);_.push(s),e.parentNode.appendChild(s)}}0<navigator.maxTouchPoints&&Ct.addEventListener("pointerenter",(t=>{const e="mouse"===t.pointerType?"remove":"add";Ct.classList[e]("touch")}),{once:!0}),A((()=>{z(),G(L,h,Bt),K(L),et(L,h),F(L,h,Bt),N(h,r,u),Bt(0,0),console.log(`Gida Slider - Show (#${t}): started`),setTimeout((()=>h.classList.add(c)),0)}));let qt=0,Dt=null,Nt=0,It=null;async function Bt(t,e){[t,e]=Pt(t,e);const s=window.performance.now();if(0!==e&&s-Nt<1e3*p)return clearTimeout(It),void(It=setTimeout((()=>Bt(t,e)),1e3*p-(s-Nt)));Nt=s;for(let e=0;e<_.length;e+=1)w[e].preDisplay(e%L===t);rt(t,L);for(let e=0;e<_.length;e+=1)w[e].transition(e%L===t,L);x(t,L),Q(t),st(t),j(t),await b.transition(t,e),E&&E(),qt=t,Mt(t)}async function Mt(t){for(let e=0;e<_.length;e+=1)w[e].display(e%L===t);if(ut(t,L),1===L)return;const e=w[t].getDuration(m,p,v);Dt&&Dt.clear(),Dt=D(Math.ceil(1e3*e),xt),await Dt.set()}async function xt(){h.classList.contains(r)&&!h.classList.contains(d)?Bt(null,1):D(1e3*m,xt).set()}function Pt(t,e){if(null===t)L-1<(t=qt+e)&&(t=0),t<0&&(t=L-1);else if(0===e&&qt!==t){e=(t<qt?qt-t:qt+L-t)<(qt<t?t-qt:t+L-qt)?-1:1}return[t,e]}const $t={move:t=>Bt(t,2===L?1:0),next:()=>Bt(qt===L-1?0:qt+1,1),prev:()=>Bt(0===qt?L-1:qt-1,-1),onTransitionEnd:t=>{E=t}};return window.GIDA.sliders[t]=$t,$t};
//# sourceMappingURL=show.min.js.map