{"version":3,"sources":["hero.js"],"names":["window","GIDA","sliders","slider_hero","id","opts","arguments","length","undefined","NS","CLS_SLIDES","CLS_START","CLS_VIEW","CLS_PAUSE","CLS_SCROLL","OFFSET_VIEW","root","document","getElementById","getElementsByClassName","effectType","timeDur","timeTran","randomTiming","lis","Array","prototype","slice","call","querySelectorAll","size","sss","effect","onTransitionEnd","resizeListeners","onResize","fn","doFirst","push","throttle","onLoad","readyState","addEventListener","setTimeout","initResizeEventHandler","l","passive","isRunning","run","requestAnimationFrame","asyncTimeout","ms","res","tid","set","Promise","r","async","clear","clearTimeout","initViewportDetection","cls","offset","IntersectionObserver","es","e","classList","isIntersecting","rootMargin","observe","visibilityState","getBoundingClientRect","h","innerHeight","top","bottom","add","remove","Slide","static","idx","cap","mnt","type","constructor","li","useCaption","this","Caption","create","isVideo","MountVideo","MountPicture","contains","getElement","insertBefore","firstChild","querySelector","getType","dataset","video","onPreDisplay","cur","m","CLS_PRE_DISPLAY","transition","display","CLS_DISPLAY","getDuration","elm","createElement","CLS_PIC","is","appendChild","CLS_DUAL","img","i","createImage","src","srcset","sizes","imgSub","keys","isCur","doRandom","RANDOM_RATE","Math","random","ar","CLS_VIDEO","vs","v","initialize","createVideo","s","setAttribute","muted","playsinline","clientWidth","clientHeight","play","pause","currentTime","duration","arFrame","TransitionSlide","slides","tranTime","_size","_lis","_time","style","transform","opacity","dir","TransitionScroll","_cur","_curPsd","_doing","_queue","ps","_calcPosition","curPsd","_doTransition","shift","curIdx","curIdxPsd","d","idxPsd","_shift","_getTransition","floor","curPs","time","tf","lenPsd","t","abs","hs","ceil","rs","j","TransitionFade","pointerEvents","hasVideo","initSlides","tryResizeVideo","onResizeSlide","isScroll","ss","finish","console","log","stStep","last","stReserve","getIdxDir","performance","now","dt","step","fs","move","next","prev"],"mappings":"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","file":"hero.min.js","sourcesContent":["/**\n * Gida Slider - Hero\n *\n * @author Takuto Yanagida\n * @version 2022-11-04\n */\n\n\nwindow.GIDA = window['GIDA'] ?? {};\n\nwindow.GIDA.sliders = window.GIDA['sliders'] ?? {};\n\nwindow.GIDA.slider_hero = function (id, opts = {}) {\n\tconst NS          = 'gida-slider-hero';\n\tconst CLS_SLIDES  = NS + '-slides';\n\tconst CLS_VISIBLE = 'visible';\n\tconst CLS_START   = 'start';\n\tconst CLS_VIEW    = 'view';\n\tconst CLS_PAUSE   = 'pause';\n\tconst CLS_SCROLL  = 'scroll';\n\tconst OFFSET_VIEW = 100;\n\n\tconst root = id ? document.getElementById(id) : document.getElementsByClassName(NS)[0];\n\tif (!root) return;\n\n\tconst effectType   = opts['effect_type']     ?? 'slide';  // 'scroll' or 'fade'\n\tconst timeDur      = opts['duration_time']   ?? 8;  // [second]\n\tconst timeTran     = opts['transition_time'] ?? 1;  // [second]\n\tconst randomTiming = opts['random_timing']   ?? false;\n\n\tconst lis  = Array.prototype.slice.call(root.querySelectorAll(`.${CLS_SLIDES} > li`));\n\tconst size = lis.length;\n\tconst sss  = [];\n\tlet effect = null;\n\n\tlet onTransitionEnd = null;\n\n\n\t// -------------------------------------------------------------------------\n\n\n\t/**\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-08-01\n\t */\n\t\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tfunction onLoad(fn) {\n\t\tif ('loading' === document.readyState) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t} else {\n\t\t\tsetTimeout(fn, 0);\n\t\t}\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction initResizeEventHandler() {\n\t\twindow.addEventListener('resize', () => { for (const l of resizeListeners) l(); }, { passive: true });\n\t}\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\tfunction run() {\n\t\t\tisRunning = false;\n\t\t\tfn();\n\t\t}\n\t\treturn () => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(run);\n\t\t};\n\t}\n\t\n\tfunction asyncTimeout(ms, fn = () => { }) {\n\t\tlet tid = null;\n\t\tlet res;\n\t\treturn {\n\t\t\tset: () => new Promise((r) => {\n\t\t\t\tres = r\n\t\t\t\ttid = setTimeout(async () => {\n\t\t\t\t\ttid = null;\n\t\t\t\t\tawait fn();\n\t\t\t\t\tr();\n\t\t\t\t}, ms);\n\t\t\t}),\n\t\t\tclear: () => {\n\t\t\t\tif (tid) {\n\t\t\t\t\tclearTimeout(tid);\n\t\t\t\t\ttid = null;\n\t\t\t\t\tres();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction initViewportDetection(root, cls, offset) {\n\t\tconst io = new IntersectionObserver((es) => {\n\t\t\tfor (const e of es) root.classList[e.isIntersecting ? 'add' : 'remove'](cls);\n\t\t}, { rootMargin: `${offset}px 0px` });\n\t\tio.observe(root);\n\t\n\t\tdocument.addEventListener('visibilitychange', () => {\n\t\t\tconst v = ('hidden' !== document.visibilityState);\n\t\t\tif (v) {\n\t\t\t\tconst r = root.getBoundingClientRect();\n\t\t\t\tconst h = window.innerHeight;\n\t\t\t\tif ((0 < r.top && r.top < h) || (0 < r.bottom && r.bottom < h)) {\n\t\t\t\t\troot.classList.add(cls);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\troot.classList.remove(cls);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * Slide\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass Slide {\n\t\n\t\tstatic CLS_SCROLL      = 'scroll';\n\t\tstatic CLS_PRE_DISPLAY = 'pre-display';\n\t\tstatic CLS_DISPLAY     = 'display';\n\t\n\t\t#idx  = 0;\n\t\t#cap  = null;\n\t\t#mnt  = null;\n\t\t#type = '';\n\t\n\t\tconstructor(li, idx, useCaption = true) {\n\t\t\tthis.#idx = idx;\n\t\t\tthis.#cap = useCaption ? Caption.create(li) : null;\n\t\n\t\t\tif (this.#isVideo(li)) {\n\t\t\t\tthis.#mnt  = new MountVideo(li);\n\t\t\t\tthis.#type = 'video';\n\t\t\t} else {\n\t\t\t\tthis.#mnt  = new MountPicture(li);\n\t\t\t\tthis.#type = 'image';\n\t\t\t}\n\t\t\tif (li.classList.contains(Slide.CLS_SCROLL)) {\n\t\t\t\tthis.#mnt.getElement().classList.add(Slide.CLS_SCROLL);\n\t\t\t}\n\t\t\tli.insertBefore(this.#mnt.getElement(), li.firstChild);\n\t\t\tconst e = li.querySelector('a') ?? li;\n\t\t\te.insertBefore(this.#mnt.getElement(), e.firstChild);\n\t\t}\n\t\n\t\tgetType() {\n\t\t\treturn this.#type;\n\t\t}\n\t\n\t\t#isVideo(li) {\n\t\t\tif (li.dataset.video) return true;\n\t\t\tconst v = li.querySelector(':scope > video, :scope > a > video');\n\t\t\treturn null !== v;\n\t\t}\n\t\n\t\tonResize() {\n\t\t\tif ('video' === this.#type && !this.#mnt.onResize()) return false;\n\t\t\tif (this.#cap) this.#cap.onResize();\n\t\t\treturn true;\n\t\t}\n\t\n\t\tonPreDisplay(cur, size) {\n\t\t\tconst m = ((this.#idx % size) === cur) ? 'add' : 'remove';\n\t\t\tthis.#mnt.getElement().classList[m](Slide.CLS_PRE_DISPLAY);\n\t\t\tif (this.#cap) this.#cap.getElement().classList[m](Slide.CLS_PRE_DISPLAY);\n\t\t}\n\t\n\t\ttransition(cur, size) {\n\t\t\tthis.#mnt.transition((this.#idx % size) === cur, size);\n\t\t}\n\t\n\t\tdisplay(cur, size) {\n\t\t\tconst m = ((this.#idx % size) === cur) ? 'add' : 'remove';\n\t\t\tthis.#mnt.getElement().classList[m](Slide.CLS_DISPLAY);\n\t\t\tif (this.#cap) this.#cap.getElement().classList[m](Slide.CLS_DISPLAY);\n\t\n\t\t\tthis.#mnt.display((this.#idx % size) === cur);\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, randomTiming) {\n\t\t\treturn this.#mnt.getDuration(timeDur, timeTran, randomTiming);\n\t\t}\n\t\n\t}\n\t/**\n\t * Mount Picture\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass MountPicture {\n\t\n\t\tstatic CLS_PIC  = NS + '-picture';\n\t\tstatic CLS_DUAL = 'dual';\n\t\n\t\tstatic RANDOM_RATE = 10;\n\t\n\t\t#elm = null;\n\t\n\t\tconstructor(li) {\n\t\t\tthis.#elm = document.createElement('div');\n\t\t\tthis.#elm.classList.add(MountPicture.CLS_PIC);\n\t\n\t\t\tconst is = li.querySelectorAll(':scope > img, :scope > a > img');\n\t\t\tif (is.length) {\n\t\t\t\tthis.#elm.appendChild(is[0]);\n\t\t\t\tif (1 < is.length) {\n\t\t\t\t\tthis.#elm.classList.add(MountPicture.CLS_DUAL);\n\t\t\t\t\tthis.#elm.appendChild(is[1]);\n\t\t\t\t}\n\t\t\t} else if (li.dataset.img) {\n\t\t\t\tconst i = this.#createImage(li, { src: 'img', srcset: 'imgSrcset', sizes: 'imgSizes' });\n\t\t\t\tthis.#elm.appendChild(i);\n\t\t\t\tif (li.dataset.imgSub) {\n\t\t\t\t\tthis.#elm.classList.add(MountPicture.CLS_DUAL);\n\t\t\t\t\tconst i = this.#createImage(li, { src: 'imgSub', srcset: 'imgSubSrcset', sizes: 'imgSubSizes' });\n\t\t\t\t\tthis.#elm.appendChild(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\t#createImage(li, keys) {\n\t\t\tconst i = document.createElement('img');\n\t\t\ti.src = li.dataset[keys.src];\n\t\n\t\t\tconst srcset = li.dataset[keys.srcset] ?? null;\n\t\t\tconst sizes  = li.dataset[keys.sizes]  ?? null;\n\t\t\tif (srcset) i.srcset = srcset;\n\t\t\tif (sizes)  i.sizes  = sizes;\n\t\t\treturn i;\n\t\t}\n\t\n\t\tgetElement() {\n\t\t\treturn this.#elm;\n\t\t}\n\t\n\t\ttransition(isCur, size) {\n\t\t}\n\t\n\t\tdisplay(isCur) {\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, doRandom) {\n\t\t\tif (doRandom) {\n\t\t\t\tconst f = (1 + 0.01 * MountPicture.RANDOM_RATE * (1 - Math.random() * 2));\n\t\t\t\treturn timeDur * f;\n\t\t\t}\n\t\t\treturn timeDur;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Mount Video\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass MountVideo {\n\t\n\t\tstatic CLS_VIDEO = NS + '-video';\n\t\n\t\t#elm   = null;\n\t\t#video = null;\n\t\t#ar    = null;\n\t\n\t\tconstructor(li) {\n\t\t\tthis.#elm = document.createElement('div');\n\t\t\tthis.#elm.classList.add(MountVideo.CLS_VIDEO);\n\t\n\t\t\tconst vs = li.querySelectorAll(':scope > video, :scope > a > video');\n\t\t\tif (1 === vs.length) {\n\t\t\t\tconst v = vs[0];\n\t\t\t\tthis.#initialize(v);\n\t\t\t\tthis.#elm.appendChild(v);\n\t\t\t\tthis.#video = v;\n\t\t\t} else if (li.dataset.video) {\n\t\t\t\tconst v = this.#createVideo(li);\n\t\t\t\tthis.#initialize(v);\n\t\t\t\tthis.#elm.appendChild(v);\n\t\t\t\tthis.#video = v;\n\t\t\t}\n\t\t}\n\t\n\t\t#createVideo(li) {\n\t\t\tconst v = document.createElement('video');\n\t\t\tconst s = document.createElement('source');\n\t\t\ts.setAttribute('src', li.dataset.video);\n\t\t\tv.appendChild(s);\n\t\t\treturn v;\n\t\t}\n\t\n\t\t#initialize(v) {\n\t\t\tv.muted = true;\n\t\t\tv.playsinline = true;\n\t\t\tv.setAttribute('muted', true);\n\t\t\tv.setAttribute('playsinline', true);\n\t\t\tv.addEventListener('loadedmetadata', () => {\n\t\t\t\tconst ar = v.clientWidth / v.clientHeight;\n\t\t\t\tthis.#ar = (0 | (ar * 1000)) / 1000;\n\t\t\t});\n\t\t}\n\t\n\t\tgetElement() {\n\t\t\treturn this.#elm;\n\t\t}\n\t\n\t\ttransition(isCur, size) {\n\t\t\tif (isCur) {\n\t\t\t\tthis.#video.setAttribute('autoplay', true);\n\t\t\t\tthis.#video.play();\n\t\t\t\tif (size === 1) this.#video.setAttribute('loop', true);\n\t\t\t}\n\t\t}\n\t\n\t\tdisplay(isCur) {\n\t\t\tif (!isCur) {\n\t\t\t\tthis.#video.pause();\n\t\t\t\tthis.#video.currentTime = 0;\n\t\t\t}\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, doRandom) {\n\t\t\treturn this.#video.duration - timeTran;\n\t\t}\n\t\n\t\tonResize() {\n\t\t\tif (!this.#ar) return false;\n\t\t\tconst arFrame = this.#elm.clientWidth / this.#elm.clientHeight;\n\t\t\tif (this.#ar < arFrame) {\n\t\t\t\tthis.#video.classList.remove('height');\n\t\t\t\tthis.#video.classList.add('width');\n\t\t\t} else {\n\t\t\t\tthis.#video.classList.remove('width');\n\t\t\t\tthis.#video.classList.add('height');\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Slide Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-06-25\n\t */\n\t\n\t\n\tclass TransitionSlide {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.transform = 'translateX(' + (i ? 100 : 0) + '%)';\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\t\tthis._lis[i].style.opacity = 1;\n\t\t\t\t\tthis._lis[i].style.transition = 'transform ' + this._time + 's';\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.transform = (i <= idx) ? 'translateX(0%)' : 'translateX(100%)';\n\t\t\t}\n\t\t\tawait asyncTimeout(this._time * 1000).set();\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Scroll Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-02\n\t */\n\t\n\t\n\tclass TransitionScroll {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tthis._cur    = 0;\n\t\t\tthis._curPsd = 0;\n\t\t\tthis._doing  = false;\n\t\t\tthis._queue  = [];\n\t\n\t\t\tconst ps = this._calcPosition(0, 1);\n\t\t\tfor (let i = 0; i < this._lis.length; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity   = 1;\n\t\t\t\tthis._lis[i].style.transform = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tthis._queue.push((cur, curPsd) => this._doTransition(cur, curPsd, idx, dir));\n\t\t\tif (this._doing) return;\n\t\t\tthis._doing = true;\n\t\t\twhile (this._queue.length) {\n\t\t\t\t[this._cur, this._curPsd] = await this._queue.shift()(this._cur, this._curPsd);\n\t\t\t}\n\t\t\tthis._doing = false;\n\t\t}\n\t\n\t\tasync _doTransition(curIdx, curIdxPsd, idx, dir) {\n\t\t\tif (0 === dir && curIdx !== idx) {\n\t\t\t\tconst r = (curIdx < idx) ? idx - curIdx : idx + this._size - curIdx;\n\t\t\t\tconst l = (idx < curIdx) ? curIdx - idx : curIdx + this._size - idx;\n\t\t\t\tdir = (l < r) ? -1 : 1;\n\t\t\t}\n\t\t\tlet ps = this._calcPosition(curIdxPsd, dir);\n\t\t\tfor (let i = 0; i < this._lis.length; i += 1) {\n\t\t\t\tthis._lis[i].style.transition = '';\n\t\t\t\tthis._lis[i].style.transform  = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t\tawait asyncTimeout(100).set();  // Wait\n\t\n\t\t\tlet d = 0;\n\t\t\tif (dir ===  1) d = idx - curIdx;\n\t\t\tif (dir === -1) d = curIdx - idx;\n\t\t\tif (d < 0) d += this._size;\n\t\n\t\t\tlet idxPsd = curIdxPsd;\n\t\t\tfor (let i = 0; i < d; i += 1) {\n\t\t\t\t[ps, idxPsd] = this._shift(ps, idxPsd, dir, this._time / d, this._getTransition(d, i));\n\t\t\t\tawait asyncTimeout(Math.floor(this._time * 1000 / d)).set();\n\t\t\t}\n\t\t\treturn [idx, idxPsd];\n\t\t}\n\t\n\t\t_getTransition(d, i) {\n\t\t\tif (d === 1) return 'ease';\n\t\t\tif (d === 2) {\n\t\t\t\tif (i === 0) return 'ease-in';\n\t\t\t\tif (i === 1) return 'ease-out';\n\t\t\t}\n\t\t\treturn 'linear';\n\t\t}\n\t\n\t\t_shift(curPs, curIdxPsd, dir, time, tf = 'ease') {\n\t\t\tconst lenPsd = this._lis.length;\n\t\n\t\t\tlet idxPsd = curIdxPsd + dir;\n\t\t\tif (lenPsd - 1 < idxPsd) idxPsd = 0;\n\t\t\tif (idxPsd < 0) idxPsd = lenPsd - 1;\n\t\n\t\t\tconst ps = this._calcPosition(idxPsd, dir);\n\t\n\t\t\tfor (let i = 0; i < lenPsd; i += 1) {\n\t\t\t\tconst t = (Math.abs(curPs[i] - ps[i]) === 1) ? `transform ${time}s ${tf}` : '';\n\t\t\t\tthis._lis[i].style.transition = t;\n\t\t\t\tthis._lis[i].style.transform  = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t\treturn [ps, idxPsd];\n\t\t}\n\t\n\t\t_calcPosition(idxPsd, dir) {\n\t\t\tconst lenPsd = this._lis.length;\n\t\t\tconst ps     = new Array(lenPsd);\n\t\n\t\t\tconst hs = (dir !== -1) ? Math.ceil((lenPsd - 1) / 2) : Math.floor((lenPsd - 1) / 2);\n\t\t\tconst rs = lenPsd - 1 - hs;\n\t\n\t\t\tfor (let i = 1; i <= hs; i += 1) {\n\t\t\t\tlet j = idxPsd + i;\n\t\t\t\tif (lenPsd - 1 < j) j -= lenPsd;\n\t\t\t\tps[j] = i;\n\t\t\t}\n\t\t\tfor (let i = 1; i <= rs; i += 1) {\n\t\t\t\tlet j = idxPsd - i;\n\t\t\t\tif (j < 0) j += lenPsd;\n\t\t\t\tps[j] = -i;\n\t\t\t}\n\t\t\tps[idxPsd] = 0;\n\t\t\treturn ps;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Fade Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-06-25\n\t */\n\t\n\t\n\tclass TransitionFade {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity = (i === 0) ? 1 : 0;\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\t\tthis._lis[i].style.transition = 'opacity ' + this._time + 's';\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity = (i === idx) ? 1 : 0;\n\t\t\t\tthis._lis[i].style.pointerEvents = (i === idx) ? 'auto' : 'none';\n\t\t\t}\n\t\t\tawait asyncTimeout(this._time * 1000).set();\n\t\t}\n\t}\n\t\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tconst hasVideo = initSlides();\n\n\tif (hasVideo) setTimeout(tryResizeVideo, 100);\n\tfunction tryResizeVideo() {\n\t\tconst finish = onResizeSlide();\n\t\tif (!finish) setTimeout(tryResizeVideo, 100);\n\t}\n\n\tonLoad(() => {\n\t\tinitResizeEventHandler();\n\n\t\tinitViewportDetection(root, CLS_VIEW, OFFSET_VIEW);\n\n\t\ttransition(0, 0);\n\t\tconsole.log(`Gida Slider - Hero (#${id}): started`);\n\t\tsetTimeout(() => root.classList.add(CLS_START), 0);\n\t});\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tfunction initSlides() {\n\t\tconst isScroll = root.classList.contains(CLS_SCROLL);\n\t\tlet hasVideo = false;\n\n\t\tfor (let i = 0; i < lis.length; i += 1) {\n\t\t\tif (isScroll) lis[i].classList.add(CLS_SCROLL);\n\n\t\t\tconst ss = new Slide(lis[i], i, false);\n\t\t\tif ('video' === ss.getType) hasVideo = true;\n\t\t\tsss.push(ss);\n\t\t}\n\t\tonResize(onResizeSlide);\n\t\tswitch (effectType) {\n\t\t\tcase 'slide' : effect = new TransitionSlide(size, lis, timeTran); break;\n\t\t\tcase 'scroll': effect = new TransitionScroll(size, lis, timeTran); break;\n\t\t\tcase 'fade'  : effect = new TransitionFade(size, lis, timeTran); break;\n\t\t\tdefault      : effect = new TransitionSlide(size, lis, timeTran); break;\n\t\t}\n\t\treturn hasVideo;\n\t}\n\n\tfunction onResizeSlide() {\n\t\tlet finish = true;\n\t\tfor (const ss of sss) {\n\t\t\tif (!ss.onResize()) finish = false;\n\t\t}\n\t\treturn finish;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tlet curIdx    = 0;\n\tlet stStep    = null;\n\tlet last      = 0;\n\tlet stReserve = null;\n\n\tasync function transition(idx, dir) {\n\t\t[idx, dir] = getIdxDir(idx, dir);\n\n\t\tconst t = window.performance.now();\n\t\tif (dir !== 0 && t - last < timeTran * 1000) {\n\t\t\tclearTimeout(stReserve);\n\t\t\tstReserve = setTimeout(() => transition(idx, dir), timeTran * 1000 - (t - last));\n\t\t\treturn;\n\t\t}\n\t\tlast = t;\n\n\t\tfor (const ss of sss) ss.onPreDisplay(idx, size);\n\t\tfor (const ss of sss) ss.transition(idx, size);\n\n\t\tawait effect.transition(idx, dir);\n\t\tif (onTransitionEnd) onTransitionEnd();\n\t\tcurIdx = idx;\n\t\tdisplay(idx);\n\t}\n\n\tasync function display(idx) {\n\t\tfor (const ss of sss) ss.display(idx, size);\n\t\tif (size === 1) return;\n\n\t\tconst dt = sss[idx].getDuration(timeDur, timeTran, randomTiming);\n\t\tif (stStep) stStep.clear();\n\t\tstStep = asyncTimeout(Math.ceil(dt * 1000), step);\n\t\tawait stStep.set();\n\t}\n\n\tasync function step() {\n\t\tif (root.classList.contains(CLS_VIEW) && !root.classList.contains(CLS_PAUSE)) {\n\t\t\ttransition(null, 1);\n\t\t} else {\n\t\t\tasyncTimeout(timeDur * 1000, step).set();\n\t\t}\n\t}\n\n\tfunction getIdxDir(idx, dir) {\n\t\tif (idx === null) {\n\t\t\tidx = curIdx + dir;\n\t\t\tif (size - 1 < idx) idx = 0;\n\t\t\tif (idx < 0) idx = size - 1;\n\t\t} else if (dir === 0) {\n\t\t\tif (curIdx < idx) {\n\t\t\t\tdir = 1;\n\t\t\t\tif ((curIdx - (idx - size)) < (idx - curIdx)) dir = -1;\n\t\t\t}\n\t\t\tif (idx < curIdx) {\n\t\t\t\tdir = -1;\n\t\t\t\tif (((idx + size) - curIdx) < (curIdx - idx)) dir = 1;\n\t\t\t}\n\t\t}\n\t\treturn [idx, dir];\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tconst fs = {\n\t\tmove: idx => transition(idx, size === 2 ? 1 : 0),\n\t\tnext: ()  => transition((curIdx === size - 1) ? 0          : (curIdx + 1),  1),\n\t\tprev: ()  => transition((curIdx === 0       ) ? (size - 1) : (curIdx - 1), -1),\n\n\t\tonTransitionEnd: fn => { onTransitionEnd = fn; }\n\t};\n\twindow.GIDA.sliders[id] = fs;\n\treturn fs;\n\n}\n"]}