{"version":3,"sources":["hero.js"],"names":["window","GIDA","sliders","slider_hero","id","opts","arguments","length","undefined","NS","CLS_SLIDES","CLS_VIEW","CLS_PAUSE","CLS_SCROLL","root","document","getElementById","getElementsByClassName","effectType","timeDur","timeTran","randomTiming","lis","Array","prototype","slice","call","querySelectorAll","size","sss","effect","onTransitionEnd","resizeListeners","onResize","fn","push","isRunning","run","requestAnimationFrame","throttle","asyncTimeout","ms","res","tid","set","Promise","r","setTimeout","async","clear","clearTimeout","Slide","static","idx","cap","mnt","type","constructor","li","useCaption","this","Caption","create","isVideo","MountVideo","MountPicture","classList","contains","getElement","add","insertBefore","firstChild","e","querySelector","getType","dataset","video","onPreDisplay","cur","m","CLS_PRE_DISPLAY","transition","display","CLS_DISPLAY","getDuration","elm","createElement","CLS_PIC","is","appendChild","CLS_DUAL","img","i","createImage","src","srcset","sizes","imgSub","keys","isCur","doRandom","RANDOM_RATE","Math","random","ar","CLS_VIDEO","vs","v","initialize","createVideo","s","setAttribute","muted","playsinline","addEventListener","clientWidth","clientHeight","play","pause","currentTime","duration","arFrame","remove","TransitionSlide","slides","tranTime","_size","_lis","_time","style","transform","opacity","dir","TransitionScroll","_cur","_curPsd","_doing","_queue","ps","_calcPosition","curPsd","_doTransition","shift","curIdx","curIdxPsd","d","idxPsd","_shift","_getTransition","floor","curPs","time","tf","lenPsd","t","abs","hs","ceil","rs","j","TransitionFade","pointerEvents","onResizeSlide","finish","ss","isScroll","hasVideo","initSlides","tryResizeVideo","l","passive","cls","offset","IntersectionObserver","es","isIntersecting","rootMargin","observe","visibilityState","getBoundingClientRect","h","innerHeight","top","bottom","initViewportDetection","console","log","readyState","stStep","last","stReserve","getIdxDir","performance","now","dt","step","fs","move","next","prev"],"mappings":"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","file":"hero.min.js","sourcesContent":["/**\n * Gida Slider - Hero\n *\n * @author Takuto Yanagida\n * @version 2022-11-04\n */\n\n\nwindow.GIDA = window['GIDA'] ?? {};\n\nwindow.GIDA.sliders = window.GIDA['sliders'] ?? {};\n\nwindow.GIDA.slider_hero = function (id, opts = {}) {\n\tconst NS          = 'gida-slider-hero';\n\tconst CLS_SLIDES  = NS + '-slides';\n\tconst CLS_VISIBLE = 'visible';\n\tconst CLS_START   = 'start';\n\tconst CLS_VIEW    = 'view';\n\tconst CLS_PAUSE   = 'pause';\n\tconst CLS_SCROLL  = 'scroll';\n\tconst OFFSET_VIEW = 100;\n\n\tconst root = id ? document.getElementById(id) : document.getElementsByClassName(NS)[0];\n\tif (!root) return;\n\n\tconst effectType   = opts['effect_type']     ?? 'slide';  // 'scroll' or 'fade'\n\tconst timeDur      = opts['duration_time']   ?? 8;  // [second]\n\tconst timeTran     = opts['transition_time'] ?? 1;  // [second]\n\tconst randomTiming = opts['random_timing']   ?? false;\n\n\tconst lis  = Array.prototype.slice.call(root.querySelectorAll(`.${CLS_SLIDES} > li`));\n\tconst size = lis.length;\n\tconst sss  = [];\n\tlet effect = null;\n\n\tlet onTransitionEnd = null;\n\n\n\t// -------------------------------------------------------------------------\n\n\n\t/**\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-08-01\n\t */\n\t\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tfunction onLoad(fn) {\n\t\tif ('loading' === document.readyState) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t} else {\n\t\t\tsetTimeout(fn, 0);\n\t\t}\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction initResizeEventHandler() {\n\t\twindow.addEventListener('resize', () => { for (const l of resizeListeners) l(); }, { passive: true });\n\t}\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\tfunction run() {\n\t\t\tisRunning = false;\n\t\t\tfn();\n\t\t}\n\t\treturn () => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(run);\n\t\t};\n\t}\n\t\n\tfunction asyncTimeout(ms, fn = () => { }) {\n\t\tlet tid = null;\n\t\tlet res;\n\t\treturn {\n\t\t\tset: () => new Promise((r) => {\n\t\t\t\tres = r\n\t\t\t\ttid = setTimeout(async () => {\n\t\t\t\t\ttid = null;\n\t\t\t\t\tawait fn();\n\t\t\t\t\tr();\n\t\t\t\t}, ms);\n\t\t\t}),\n\t\t\tclear: () => {\n\t\t\t\tif (tid) {\n\t\t\t\t\tclearTimeout(tid);\n\t\t\t\t\ttid = null;\n\t\t\t\t\tres();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction initViewportDetection(root, cls, offset) {\n\t\tconst io = new IntersectionObserver((es) => {\n\t\t\tfor (const e of es) root.classList[e.isIntersecting ? 'add' : 'remove'](cls);\n\t\t}, { rootMargin: `${offset}px 0px` });\n\t\tio.observe(root);\n\t\n\t\tdocument.addEventListener('visibilitychange', () => {\n\t\t\tconst v = ('hidden' !== document.visibilityState);\n\t\t\tif (v) {\n\t\t\t\tconst r = root.getBoundingClientRect();\n\t\t\t\tconst h = window.innerHeight;\n\t\t\t\tif ((0 < r.top && r.top < h) || (0 < r.bottom && r.bottom < h)) {\n\t\t\t\t\troot.classList.add(cls);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\troot.classList.remove(cls);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * Slide\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass Slide {\n\t\n\t\tstatic CLS_SCROLL      = 'scroll';\n\t\tstatic CLS_PRE_DISPLAY = 'pre-display';\n\t\tstatic CLS_DISPLAY     = 'display';\n\t\n\t\t#idx  = 0;\n\t\t#cap  = null;\n\t\t#mnt  = null;\n\t\t#type = '';\n\t\n\t\tconstructor(li, idx, useCaption = true) {\n\t\t\tthis.#idx = idx;\n\t\t\tthis.#cap = useCaption ? Caption.create(li) : null;\n\t\n\t\t\tif (this.#isVideo(li)) {\n\t\t\t\tthis.#mnt  = new MountVideo(li);\n\t\t\t\tthis.#type = 'video';\n\t\t\t} else {\n\t\t\t\tthis.#mnt  = new MountPicture(li);\n\t\t\t\tthis.#type = 'image';\n\t\t\t}\n\t\t\tif (li.classList.contains(Slide.CLS_SCROLL)) {\n\t\t\t\tthis.#mnt.getElement().classList.add(Slide.CLS_SCROLL);\n\t\t\t}\n\t\t\tli.insertBefore(this.#mnt.getElement(), li.firstChild);\n\t\t\tconst e = li.querySelector('a') ?? li;\n\t\t\te.insertBefore(this.#mnt.getElement(), e.firstChild);\n\t\t}\n\t\n\t\tgetType() {\n\t\t\treturn this.#type;\n\t\t}\n\t\n\t\t#isVideo(li) {\n\t\t\tif (li.dataset.video) return true;\n\t\t\tconst v = li.querySelector(':scope > video, :scope > a > video');\n\t\t\treturn null !== v;\n\t\t}\n\t\n\t\tonResize() {\n\t\t\tif ('video' === this.#type && !this.#mnt.onResize()) return false;\n\t\t\tif (this.#cap) this.#cap.onResize();\n\t\t\treturn true;\n\t\t}\n\t\n\t\tonPreDisplay(cur, size) {\n\t\t\tconst m = ((this.#idx % size) === cur) ? 'add' : 'remove';\n\t\t\tthis.#mnt.getElement().classList[m](Slide.CLS_PRE_DISPLAY);\n\t\t\tif (this.#cap) this.#cap.getElement().classList[m](Slide.CLS_PRE_DISPLAY);\n\t\t}\n\t\n\t\ttransition(cur, size) {\n\t\t\tthis.#mnt.transition((this.#idx % size) === cur, size);\n\t\t}\n\t\n\t\tdisplay(cur, size) {\n\t\t\tconst m = ((this.#idx % size) === cur) ? 'add' : 'remove';\n\t\t\tthis.#mnt.getElement().classList[m](Slide.CLS_DISPLAY);\n\t\t\tif (this.#cap) this.#cap.getElement().classList[m](Slide.CLS_DISPLAY);\n\t\n\t\t\tthis.#mnt.display((this.#idx % size) === cur);\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, randomTiming) {\n\t\t\treturn this.#mnt.getDuration(timeDur, timeTran, randomTiming);\n\t\t}\n\t\n\t}\n\t/**\n\t * Mount Picture\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass MountPicture {\n\t\n\t\tstatic CLS_PIC  = NS + '-picture';\n\t\tstatic CLS_DUAL = 'dual';\n\t\n\t\tstatic RANDOM_RATE = 10;\n\t\n\t\t#elm = null;\n\t\n\t\tconstructor(li) {\n\t\t\tthis.#elm = document.createElement('div');\n\t\t\tthis.#elm.classList.add(MountPicture.CLS_PIC);\n\t\n\t\t\tconst is = li.querySelectorAll(':scope > img, :scope > a > img');\n\t\t\tif (is.length) {\n\t\t\t\tthis.#elm.appendChild(is[0]);\n\t\t\t\tif (1 < is.length) {\n\t\t\t\t\tthis.#elm.classList.add(MountPicture.CLS_DUAL);\n\t\t\t\t\tthis.#elm.appendChild(is[1]);\n\t\t\t\t}\n\t\t\t} else if (li.dataset.img) {\n\t\t\t\tconst i = this.#createImage(li, { src: 'img', srcset: 'imgSrcset', sizes: 'imgSizes' });\n\t\t\t\tthis.#elm.appendChild(i);\n\t\t\t\tif (li.dataset.imgSub) {\n\t\t\t\t\tthis.#elm.classList.add(MountPicture.CLS_DUAL);\n\t\t\t\t\tconst i = this.#createImage(li, { src: 'imgSub', srcset: 'imgSubSrcset', sizes: 'imgSubSizes' });\n\t\t\t\t\tthis.#elm.appendChild(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\t#createImage(li, keys) {\n\t\t\tconst i = document.createElement('img');\n\t\t\ti.src = li.dataset[keys.src];\n\t\n\t\t\tconst srcset = li.dataset[keys.srcset] ?? null;\n\t\t\tconst sizes  = li.dataset[keys.sizes]  ?? null;\n\t\t\tif (srcset) i.srcset = srcset;\n\t\t\tif (sizes)  i.sizes  = sizes;\n\t\t\treturn i;\n\t\t}\n\t\n\t\tgetElement() {\n\t\t\treturn this.#elm;\n\t\t}\n\t\n\t\ttransition(isCur, size) {\n\t\t}\n\t\n\t\tdisplay(isCur) {\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, doRandom) {\n\t\t\tif (doRandom) {\n\t\t\t\tconst f = (1 + 0.01 * MountPicture.RANDOM_RATE * (1 - Math.random() * 2));\n\t\t\t\treturn timeDur * f;\n\t\t\t}\n\t\t\treturn timeDur;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Mount Video\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-03\n\t */\n\t\n\tclass MountVideo {\n\t\n\t\tstatic CLS_VIDEO = NS + '-video';\n\t\n\t\t#elm   = null;\n\t\t#video = null;\n\t\t#ar    = null;\n\t\n\t\tconstructor(li) {\n\t\t\tthis.#elm = document.createElement('div');\n\t\t\tthis.#elm.classList.add(MountVideo.CLS_VIDEO);\n\t\n\t\t\tconst vs = li.querySelectorAll(':scope > video, :scope > a > video');\n\t\t\tif (1 === vs.length) {\n\t\t\t\tconst v = vs[0];\n\t\t\t\tthis.#initialize(v);\n\t\t\t\tthis.#elm.appendChild(v);\n\t\t\t\tthis.#video = v;\n\t\t\t} else if (li.dataset.video) {\n\t\t\t\tconst v = this.#createVideo(li);\n\t\t\t\tthis.#initialize(v);\n\t\t\t\tthis.#elm.appendChild(v);\n\t\t\t\tthis.#video = v;\n\t\t\t}\n\t\t}\n\t\n\t\t#createVideo(li) {\n\t\t\tconst v = document.createElement('video');\n\t\t\tconst s = document.createElement('source');\n\t\t\ts.setAttribute('src', li.dataset.video);\n\t\t\tv.appendChild(s);\n\t\t\treturn v;\n\t\t}\n\t\n\t\t#initialize(v) {\n\t\t\tv.muted = true;\n\t\t\tv.playsinline = true;\n\t\t\tv.setAttribute('muted', true);\n\t\t\tv.setAttribute('playsinline', true);\n\t\t\tv.addEventListener('loadedmetadata', () => {\n\t\t\t\tconst ar = v.clientWidth / v.clientHeight;\n\t\t\t\tthis.#ar = (0 | (ar * 1000)) / 1000;\n\t\t\t});\n\t\t}\n\t\n\t\tgetElement() {\n\t\t\treturn this.#elm;\n\t\t}\n\t\n\t\ttransition(isCur, size) {\n\t\t\tif (isCur) {\n\t\t\t\tthis.#video.setAttribute('autoplay', true);\n\t\t\t\tthis.#video.play();\n\t\t\t\tif (size === 1) this.#video.setAttribute('loop', true);\n\t\t\t}\n\t\t}\n\t\n\t\tdisplay(isCur) {\n\t\t\tif (!isCur) {\n\t\t\t\tthis.#video.pause();\n\t\t\t\tthis.#video.currentTime = 0;\n\t\t\t}\n\t\t}\n\t\n\t\tgetDuration(timeDur, timeTran, doRandom) {\n\t\t\treturn this.#video.duration - timeTran;\n\t\t}\n\t\n\t\tonResize() {\n\t\t\tif (!this.#ar) return false;\n\t\t\tconst arFrame = this.#elm.clientWidth / this.#elm.clientHeight;\n\t\t\tif (this.#ar < arFrame) {\n\t\t\t\tthis.#video.classList.remove('height');\n\t\t\t\tthis.#video.classList.add('width');\n\t\t\t} else {\n\t\t\t\tthis.#video.classList.remove('width');\n\t\t\t\tthis.#video.classList.add('height');\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Slide Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-06-25\n\t */\n\t\n\t\n\tclass TransitionSlide {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.transform = 'translateX(' + (i ? 100 : 0) + '%)';\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\t\tthis._lis[i].style.opacity = 1;\n\t\t\t\t\tthis._lis[i].style.transition = 'transform ' + this._time + 's';\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.transform = (i <= idx) ? 'translateX(0%)' : 'translateX(100%)';\n\t\t\t}\n\t\t\tawait asyncTimeout(this._time * 1000).set();\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Scroll Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2022-11-02\n\t */\n\t\n\t\n\tclass TransitionScroll {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tthis._cur    = 0;\n\t\t\tthis._curPsd = 0;\n\t\t\tthis._doing  = false;\n\t\t\tthis._queue  = [];\n\t\n\t\t\tconst ps = this._calcPosition(0, 1);\n\t\t\tfor (let i = 0; i < this._lis.length; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity   = 1;\n\t\t\t\tthis._lis[i].style.transform = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tthis._queue.push((cur, curPsd) => this._doTransition(cur, curPsd, idx, dir));\n\t\t\tif (this._doing) return;\n\t\t\tthis._doing = true;\n\t\t\twhile (this._queue.length) {\n\t\t\t\t[this._cur, this._curPsd] = await this._queue.shift()(this._cur, this._curPsd);\n\t\t\t}\n\t\t\tthis._doing = false;\n\t\t}\n\t\n\t\tasync _doTransition(curIdx, curIdxPsd, idx, dir) {\n\t\t\tif (0 === dir && curIdx !== idx) {\n\t\t\t\tconst r = (curIdx < idx) ? idx - curIdx : idx + this._size - curIdx;\n\t\t\t\tconst l = (idx < curIdx) ? curIdx - idx : curIdx + this._size - idx;\n\t\t\t\tdir = (l < r) ? -1 : 1;\n\t\t\t}\n\t\t\tlet ps = this._calcPosition(curIdxPsd, dir);\n\t\t\tfor (let i = 0; i < this._lis.length; i += 1) {\n\t\t\t\tthis._lis[i].style.transition = '';\n\t\t\t\tthis._lis[i].style.transform  = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t\tawait asyncTimeout(100).set();  // Wait\n\t\n\t\t\tlet d = 0;\n\t\t\tif (dir ===  1) d = idx - curIdx;\n\t\t\tif (dir === -1) d = curIdx - idx;\n\t\t\tif (d < 0) d += this._size;\n\t\n\t\t\tlet idxPsd = curIdxPsd;\n\t\t\tfor (let i = 0; i < d; i += 1) {\n\t\t\t\t[ps, idxPsd] = this._shift(ps, idxPsd, dir, this._time / d, this._getTransition(d, i));\n\t\t\t\tawait asyncTimeout(Math.floor(this._time * 1000 / d)).set();\n\t\t\t}\n\t\t\treturn [idx, idxPsd];\n\t\t}\n\t\n\t\t_getTransition(d, i) {\n\t\t\tif (d === 1) return 'ease';\n\t\t\tif (d === 2) {\n\t\t\t\tif (i === 0) return 'ease-in';\n\t\t\t\tif (i === 1) return 'ease-out';\n\t\t\t}\n\t\t\treturn 'linear';\n\t\t}\n\t\n\t\t_shift(curPs, curIdxPsd, dir, time, tf = 'ease') {\n\t\t\tconst lenPsd = this._lis.length;\n\t\n\t\t\tlet idxPsd = curIdxPsd + dir;\n\t\t\tif (lenPsd - 1 < idxPsd) idxPsd = 0;\n\t\t\tif (idxPsd < 0) idxPsd = lenPsd - 1;\n\t\n\t\t\tconst ps = this._calcPosition(idxPsd, dir);\n\t\n\t\t\tfor (let i = 0; i < lenPsd; i += 1) {\n\t\t\t\tconst t = (Math.abs(curPs[i] - ps[i]) === 1) ? `transform ${time}s ${tf}` : '';\n\t\t\t\tthis._lis[i].style.transition = t;\n\t\t\t\tthis._lis[i].style.transform  = `translateX(${ps[i] * 100}%)`;\n\t\t\t}\n\t\t\treturn [ps, idxPsd];\n\t\t}\n\t\n\t\t_calcPosition(idxPsd, dir) {\n\t\t\tconst lenPsd = this._lis.length;\n\t\t\tconst ps     = new Array(lenPsd);\n\t\n\t\t\tconst hs = (dir !== -1) ? Math.ceil((lenPsd - 1) / 2) : Math.floor((lenPsd - 1) / 2);\n\t\t\tconst rs = lenPsd - 1 - hs;\n\t\n\t\t\tfor (let i = 1; i <= hs; i += 1) {\n\t\t\t\tlet j = idxPsd + i;\n\t\t\t\tif (lenPsd - 1 < j) j -= lenPsd;\n\t\t\t\tps[j] = i;\n\t\t\t}\n\t\t\tfor (let i = 1; i <= rs; i += 1) {\n\t\t\t\tlet j = idxPsd - i;\n\t\t\t\tif (j < 0) j += lenPsd;\n\t\t\t\tps[j] = -i;\n\t\t\t}\n\t\t\tps[idxPsd] = 0;\n\t\t\treturn ps;\n\t\t}\n\t\n\t}\n\t\n\t/**\n\t * Fade Transition\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-06-25\n\t */\n\t\n\t\n\tclass TransitionFade {\n\t\n\t\tconstructor(size, slides, tranTime) {\n\t\t\tthis._size = size;\n\t\t\tthis._lis  = slides;\n\t\t\tthis._time = tranTime;\n\t\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity = (i === 0) ? 1 : 0;\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\t\tthis._lis[i].style.transition = 'opacity ' + this._time + 's';\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\n\t\tasync transition(idx, dir) {\n\t\t\tfor (let i = 0; i < this._size; i += 1) {\n\t\t\t\tthis._lis[i].style.opacity = (i === idx) ? 1 : 0;\n\t\t\t\tthis._lis[i].style.pointerEvents = (i === idx) ? 'auto' : 'none';\n\t\t\t}\n\t\t\tawait asyncTimeout(this._time * 1000).set();\n\t\t}\n\t}\n\t\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tconst hasVideo = initSlides();\n\n\tif (hasVideo) setTimeout(tryResizeVideo, 100);\n\tfunction tryResizeVideo() {\n\t\tconst finish = onResizeSlide();\n\t\tif (!finish) setTimeout(tryResizeVideo, 100);\n\t}\n\n\tonLoad(() => {\n\t\tinitResizeEventHandler();\n\n\t\tinitViewportDetection(root, CLS_VIEW, OFFSET_VIEW);\n\n\t\ttransition(0, 0);\n\t\tconsole.log(`Gida Slider - Hero (#${id}): started`);\n\t\tsetTimeout(() => root.classList.add(CLS_START), 0);\n\t});\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tfunction initSlides() {\n\t\tconst isScroll = root.classList.contains(CLS_SCROLL);\n\t\tlet hasVideo = false;\n\n\t\tfor (let i = 0; i < lis.length; i += 1) {\n\t\t\tif (isScroll) lis[i].classList.add(CLS_SCROLL);\n\n\t\t\tconst ss = new Slide(lis[i], i, false);\n\t\t\tif ('video' === ss.getType) hasVideo = true;\n\t\t\tsss.push(ss);\n\t\t}\n\t\tonResize(onResizeSlide);\n\t\tswitch (effectType) {\n\t\t\tcase 'slide' : effect = new TransitionSlide(size, lis, timeTran); break;\n\t\t\tcase 'scroll': effect = new TransitionScroll(size, lis, timeTran); break;\n\t\t\tcase 'fade'  : effect = new TransitionFade(size, lis, timeTran); break;\n\t\t\tdefault      : effect = new TransitionSlide(size, lis, timeTran); break;\n\t\t}\n\t\treturn hasVideo;\n\t}\n\n\tfunction onResizeSlide() {\n\t\tlet finish = true;\n\t\tfor (const ss of sss) {\n\t\t\tif (!ss.onResize()) finish = false;\n\t\t}\n\t\treturn finish;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tlet curIdx    = 0;\n\tlet stStep    = null;\n\tlet last      = 0;\n\tlet stReserve = null;\n\n\tasync function transition(idx, dir) {\n\t\t[idx, dir] = getIdxDir(idx, dir);\n\n\t\tconst t = window.performance.now();\n\t\tif (dir !== 0 && t - last < timeTran * 1000) {\n\t\t\tclearTimeout(stReserve);\n\t\t\tstReserve = setTimeout(() => transition(idx, dir), timeTran * 1000 - (t - last));\n\t\t\treturn;\n\t\t}\n\t\tlast = t;\n\n\t\tfor (const ss of sss) ss.onPreDisplay(idx, size);\n\t\tfor (const ss of sss) ss.transition(idx, size);\n\n\t\tawait effect.transition(idx, dir);\n\t\tif (onTransitionEnd) onTransitionEnd();\n\t\tcurIdx = idx;\n\t\tdisplay(idx);\n\t}\n\n\tasync function display(idx) {\n\t\tfor (const ss of sss) ss.display(idx, size);\n\t\tif (size === 1) return;\n\n\t\tconst dt = sss[idx].getDuration(timeDur, timeTran, randomTiming);\n\t\tif (stStep) stStep.clear();\n\t\tstStep = asyncTimeout(Math.ceil(dt * 1000), step);\n\t\tawait stStep.set();\n\t}\n\n\tasync function step() {\n\t\tif (root.classList.contains(CLS_VIEW) && !root.classList.contains(CLS_PAUSE)) {\n\t\t\ttransition(null, 1);\n\t\t} else {\n\t\t\tasyncTimeout(timeDur * 1000, step).set();\n\t\t}\n\t}\n\n\tfunction getIdxDir(idx, dir) {\n\t\tif (idx === null) {\n\t\t\tidx = curIdx + dir;\n\t\t\tif (size - 1 < idx) idx = 0;\n\t\t\tif (idx < 0) idx = size - 1;\n\t\t} else if (dir === 0) {\n\t\t\tif (curIdx < idx) {\n\t\t\t\tdir = 1;\n\t\t\t\tif ((curIdx - (idx - size)) < (idx - curIdx)) dir = -1;\n\t\t\t}\n\t\t\tif (idx < curIdx) {\n\t\t\t\tdir = -1;\n\t\t\t\tif (((idx + size) - curIdx) < (curIdx - idx)) dir = 1;\n\t\t\t}\n\t\t}\n\t\treturn [idx, dir];\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tconst fs = {\n\t\tmove: idx => transition(idx, size === 2 ? 1 : 0),\n\t\tnext: ()  => transition((curIdx === size - 1) ? 0          : (curIdx + 1),  1),\n\t\tprev: ()  => transition((curIdx === 0       ) ? (size - 1) : (curIdx - 1), -1),\n\n\t\tonTransitionEnd: fn => { onTransitionEnd = fn; }\n\t};\n\twindow.GIDA.sliders[id] = fs;\n\treturn fs;\n\n}\n"]}