"use strict";window.GIDA=window.GIDA??{},window.GIDA.sliders=window.GIDA.sliders??{},window.GIDA.slider_hero=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i="gida-slider-hero",s=i+"-slides",n="start",o="view",l="pause",a="scroll",r=100,c=t?document.getElementById(t):document.getElementsByClassName(i)[0];if(!c)return;const h=e.effect_type??"slide",d=e.duration_time??8,u=e.transition_time??1,m=e.random_timing??!1,_=Array.prototype.slice.call(c.querySelectorAll(`.${s} > li`)),f=_.length,p=[];let g=null,y=null;const L=[];function v(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&t(),L.push(C(t))}function S(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):setTimeout(t,0)}function w(){window.addEventListener("resize",(()=>{for(const t of L)t()}),{passive:!0})}function C(t){let e;function i(){e=!1,t()}return()=>{e||(e=!0,requestAnimationFrame(i))}}function A(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=null;return{set:()=>new Promise((n=>{e=n,s=setTimeout((async()=>{s=null,await i(),n()}),t)})),clear:()=>{s&&(clearTimeout(s),s=null,e())}}}function E(t,e,i){new IntersectionObserver((i=>{for(const s of i)t.classList[s.isIntersecting?"add":"remove"](e)}),{rootMargin:`${i}px 0px`}).observe(t),document.addEventListener("visibilitychange",(()=>{if("hidden"!==document.visibilityState){const i=t.getBoundingClientRect(),s=window.innerHeight;(0<i.top&&i.top<s||0<i.bottom&&i.bottom<s)&&t.classList.add(e)}else t.classList.remove(e)}))}class z{static CLS_SCROLL="scroll";static CLS_PRE_DISPLAY="pre-display";static CLS_DISPLAY="display";#t=0;#e=null;#i=null;#s="";constructor(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.#t=e,this.#e=i?Caption.create(t):null,this.#n(t)?(this.#i=new I(t),this.#s="video"):(this.#i=new D(t),this.#s="image"),t.classList.contains(z.CLS_SCROLL)&&this.#i.getElement().classList.add(z.CLS_SCROLL),t.insertBefore(this.#i.getElement(),t.firstChild);const s=t.querySelector("a")??t;s.insertBefore(this.#i.getElement(),s.firstChild)}getType(){return this.#s}#n(t){if(t.dataset.video)return!0;return null!==t.querySelector(":scope > video, :scope > a > video")}onResize(){return!("video"===this.#s&&!this.#i.onResize())&&(this.#e&&this.#e.onResize(),!0)}onPreDisplay(t,e){const i=this.#t%e===t?"add":"remove";this.#i.getElement().classList[i](z.CLS_PRE_DISPLAY),this.#e&&this.#e.getElement().classList[i](z.CLS_PRE_DISPLAY)}transition(t,e){this.#i.transition(this.#t%e===t,e)}display(t,e){const i=this.#t%e===t?"add":"remove";this.#i.getElement().classList[i](z.CLS_DISPLAY),this.#e&&this.#e.getElement().classList[i](z.CLS_DISPLAY),this.#i.display(this.#t%e===t)}getDuration(t,e,i){return this.#i.getDuration(t,e,i)}}class D{static CLS_PIC=i+"-picture";static CLS_DUAL="dual";static RANDOM_RATE=10;#o=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(D.CLS_PIC);const e=t.querySelectorAll(":scope > img, :scope > a > img");if(e.length)this.#o.appendChild(e[0]),1<e.length&&(this.#o.classList.add(D.CLS_DUAL),this.#o.appendChild(e[1]));else if(t.dataset.img){const e=this.#l(t,{src:"img",srcset:"imgSrcset",sizes:"imgSizes"});if(this.#o.appendChild(e),t.dataset.imgSub){this.#o.classList.add(D.CLS_DUAL);const e=this.#l(t,{src:"imgSub",srcset:"imgSubSrcset",sizes:"imgSubSizes"});this.#o.appendChild(e)}}}#l(t,e){const i=document.createElement("img");i.src=t.dataset[e.src];const s=t.dataset[e.srcset]??null,n=t.dataset[e.sizes]??null;return s&&(i.srcset=s),n&&(i.sizes=n),i}getElement(){return this.#o}transition(t,e){}display(t){}getDuration(t,e,i){if(i){return t*(1+.01*D.RANDOM_RATE*(1-2*Math.random()))}return t}}class I{static CLS_VIDEO=i+"-video";#o=null;#a=null;#r=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(I.CLS_VIDEO);const e=t.querySelectorAll(":scope > video, :scope > a > video");if(1===e.length){const t=e[0];this.#c(t),this.#o.appendChild(t),this.#a=t}else if(t.dataset.video){const e=this.#h(t);this.#c(e),this.#o.appendChild(e),this.#a=e}}#h(t){const e=document.createElement("video"),i=document.createElement("source");return i.setAttribute("src",t.dataset.video),e.appendChild(i),e}#c(t){t.muted=!0,t.playsinline=!0,t.setAttribute("muted",!0),t.setAttribute("playsinline",!0),t.addEventListener("loadedmetadata",(()=>{const e=t.clientWidth/t.clientHeight;this.#r=(0|1e3*e)/1e3}))}getElement(){return this.#o}transition(t,e){t&&(this.#a.setAttribute("autoplay",!0),this.#a.play(),1===e&&this.#a.setAttribute("loop",!0))}display(t){t||(this.#a.pause(),this.#a.currentTime=0)}getDuration(t,e,i){return this.#a.duration-e}onResize(){if(!this.#r)return!1;const t=this.#o.clientWidth/this.#o.clientHeight;return this.#r<t?(this.#a.classList.remove("height"),this.#a.classList.add("width")):(this.#a.classList.remove("width"),this.#a.classList.add("height")),!0}}class P{constructor(t,e,i){this._size=t,this._lis=e,this._time=i;for(let t=0;t<this._size;t+=1)this._lis[t].style.transform="translateX("+(t?100:0)+"%)";setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transition="transform "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.transform=e<=t?"translateX(0%)":"translateX(100%)";await A(1e3*this._time).set()}}class T{constructor(t,e,i){this._size=t,this._lis=e,this._time=i,this._cur=0,this._curPsd=0,this._doing=!1,this._queue=[];const s=this._calcPosition(0,1);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transform=`translateX(${100*s[t]}%)`}async transition(t,e){if(this._queue.push(((i,s)=>this._doTransition(i,s,t,e))),!this._doing){for(this._doing=!0;this._queue.length;)[this._cur,this._curPsd]=await this._queue.shift()(this._cur,this._curPsd);this._doing=!1}}async _doTransition(t,e,i,s){if(0===s&&t!==i){const e=t<i?i-t:i+this._size-t;s=(i<t?t-i:t+this._size-i)<e?-1:1}let n=this._calcPosition(e,s);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.transition="",this._lis[t].style.transform=`translateX(${100*n[t]}%)`;await A(100).set();let o=0;1===s&&(o=i-t),-1===s&&(o=t-i),o<0&&(o+=this._size);let l=e;for(let t=0;t<o;t+=1)[n,l]=this._shift(n,l,s,this._time/o,this._getTransition(o,t)),await A(Math.floor(1e3*this._time/o)).set();return[i,l]}_getTransition(t,e){if(1===t)return"ease";if(2===t){if(0===e)return"ease-in";if(1===e)return"ease-out"}return"linear"}_shift(t,e,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"ease";const o=this._lis.length;let l=e+i;o-1<l&&(l=0),l<0&&(l=o-1);const a=this._calcPosition(l,i);for(let e=0;e<o;e+=1){const i=1===Math.abs(t[e]-a[e])?`transform ${s}s ${n}`:"";this._lis[e].style.transition=i,this._lis[e].style.transform=`translateX(${100*a[e]}%)`}return[a,l]}_calcPosition(t,e){const i=this._lis.length,s=new Array(i),n=-1!==e?Math.ceil((i-1)/2):Math.floor((i-1)/2),o=i-1-n;for(let e=1;e<=n;e+=1){let n=t+e;i-1<n&&(n-=i),s[n]=e}for(let e=1;e<=o;e+=1){let n=t-e;n<0&&(n+=i),s[n]=-e}return s[t]=0,s}}class b{constructor(t,e,i){this._size=t,this._lis=e,this._time=i;for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=0===t?1:0;setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.transition="opacity "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.opacity=e===t?1:0,this._lis[e].style.pointerEvents=e===t?"auto":"none";await A(1e3*this._time).set()}}const R=M();function q(){x()||setTimeout(q,100)}function M(){const t=c.classList.contains(a);let e=!1;for(let i=0;i<_.length;i+=1){t&&_[i].classList.add(a);const s=new z(_[i],i,!1);"video"===s.getType&&(e=!0),p.push(s)}switch(v(x),h){case"slide":default:g=new P(f,_,u);break;case"scroll":g=new T(f,_,u);break;case"fade":g=new b(f,_,u)}return e}function x(){let t=!0;for(const e of p)e.onResize()||(t=!1);return t}R&&setTimeout(q,100),S((()=>{w(),E(c,o,r),X(0,0),console.log(`Gida Slider - Hero (#${t}): started`),setTimeout((()=>c.classList.add(n)),0)}));let O=0,$=null,G=0,V=null;async function X(t,e){[t,e]=H(t,e);const i=window.performance.now();if(0!==e&&i-G<1e3*u)return clearTimeout(V),void(V=setTimeout((()=>X(t,e)),1e3*u-(i-G)));G=i;for(const e of p)e.onPreDisplay(t,f);for(const e of p)e.transition(t,f);await g.transition(t,e),y&&y(),O=t,Y(t)}async function Y(t){for(const e of p)e.display(t,f);if(1===f)return;const e=p[t].getDuration(d,u,m);$&&$.clear(),$=A(Math.ceil(1e3*e),B),await $.set()}async function B(){c.classList.contains(o)&&!c.classList.contains(l)?X(null,1):A(1e3*d,B).set()}function H(t,e){return null===t?(f-1<(t=O+e)&&(t=0),t<0&&(t=f-1)):0===e&&(O<t&&(e=1,O-(t-f)<t-O&&(e=-1)),t<O&&(e=-1,t+f-O<O-t&&(e=1))),[t,e]}const N={move:t=>X(t,2===f?1:0),next:()=>X(O===f-1?0:O+1,1),prev:()=>X(0===O?f-1:O-1,-1),onTransitionEnd:t=>{y=t}};return window.GIDA.sliders[t]=N,N};
//# sourceMappingURL=hero.min.js.map