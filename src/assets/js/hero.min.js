"use strict";window.GIDA=window.GIDA??{},window.GIDA.sliders=window.GIDA.sliders??{},window.GIDA.slider_hero=function(t,e={}){const i="gida-slider-hero",s=i+"-slides",n="view",o="pause",l="scroll",a=t?document.getElementById(t):document.getElementsByClassName(i)[0];if(!a)return;const r=e.effect_type??"slide",c=e.duration_time??8,h=e.transition_time??1,d=e.random_timing??!1,u=Array.prototype.slice.call(a.querySelectorAll(`.${s} > li`)),m=u.length,_=[];let f=null,p=null;const g=[];function y(t,e=!1){e&&t(),g.push(function(t){let e;function i(){e=!1,t()}return()=>{e||(e=!0,requestAnimationFrame(i))}}(t))}function L(t,e=()=>{}){let i,s=null;return{set:()=>new Promise((n=>{i=n,s=setTimeout((async()=>{s=null,await e(),n()}),t)})),clear:()=>{s&&(clearTimeout(s),s=null,i())}}}class v{static CLS_SCROLL="scroll";static CLS_PRE_DISPLAY="pre-display";static CLS_DISPLAY="display";#t=0;#e=null;#i=null;#s="";constructor(t,e,i=!0){this.#t=e,this.#e=i?Caption.create(t):null,this.#n(t)?(this.#i=new w(t),this.#s="video"):(this.#i=new S(t),this.#s="image"),t.classList.contains(v.CLS_SCROLL)&&this.#i.getElement().classList.add(v.CLS_SCROLL),t.insertBefore(this.#i.getElement(),t.firstChild);const s=t.querySelector("a")??t;s.insertBefore(this.#i.getElement(),s.firstChild)}getType(){return this.#s}#n(t){if(t.dataset.video)return!0;return null!==t.querySelector(":scope > video, :scope > a > video")}onResize(){return!("video"===this.#s&&!this.#i.onResize())&&(this.#e&&this.#e.onResize(),!0)}onPreDisplay(t,e){const i=this.#t%e===t?"add":"remove";this.#i.getElement().classList[i](v.CLS_PRE_DISPLAY),this.#e&&this.#e.getElement().classList[i](v.CLS_PRE_DISPLAY)}transition(t,e){this.#i.transition(this.#t%e===t,e)}display(t,e){const i=this.#t%e===t?"add":"remove";this.#i.getElement().classList[i](v.CLS_DISPLAY),this.#e&&this.#e.getElement().classList[i](v.CLS_DISPLAY),this.#i.display(this.#t%e===t)}getDuration(t,e,i){return this.#i.getDuration(t,e,i)}}class S{static CLS_PIC=i+"-picture";static CLS_DUAL="dual";static RANDOM_RATE=10;#o=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(S.CLS_PIC);const e=t.querySelectorAll(":scope > img, :scope > a > img");if(e.length)this.#o.appendChild(e[0]),1<e.length&&(this.#o.classList.add(S.CLS_DUAL),this.#o.appendChild(e[1]));else if(t.dataset.img){const e=this.#l(t,{src:"img",srcset:"imgSrcset",sizes:"imgSizes"});if(this.#o.appendChild(e),t.dataset.imgSub){this.#o.classList.add(S.CLS_DUAL);const e=this.#l(t,{src:"imgSub",srcset:"imgSubSrcset",sizes:"imgSubSizes"});this.#o.appendChild(e)}}}#l(t,e){const i=document.createElement("img");i.src=t.dataset[e.src];const s=t.dataset[e.srcset]??null,n=t.dataset[e.sizes]??null;return s&&(i.srcset=s),n&&(i.sizes=n),i}getElement(){return this.#o}transition(t,e){}display(t){}getDuration(t,e,i){if(i){return t*(1+.01*S.RANDOM_RATE*(1-2*Math.random()))}return t}}class w{static CLS_VIDEO=i+"-video";#o=null;#a=null;#r=null;constructor(t){this.#o=document.createElement("div"),this.#o.classList.add(w.CLS_VIDEO);const e=t.querySelectorAll(":scope > video, :scope > a > video");if(1===e.length){const t=e[0];this.#c(t),this.#o.appendChild(t),this.#a=t}else if(t.dataset.video){const e=this.#h(t);this.#c(e),this.#o.appendChild(e),this.#a=e}}#h(t){const e=document.createElement("video"),i=document.createElement("source");return i.setAttribute("src",t.dataset.video),e.appendChild(i),e}#c(t){t.muted=!0,t.playsinline=!0,t.setAttribute("muted",!0),t.setAttribute("playsinline",!0),t.addEventListener("loadedmetadata",(()=>{const e=t.clientWidth/t.clientHeight;this.#r=(0|1e3*e)/1e3}))}getElement(){return this.#o}transition(t,e){t&&(this.#a.setAttribute("autoplay",!0),this.#a.play(),1===e&&this.#a.setAttribute("loop",!0))}display(t){t||(this.#a.pause(),this.#a.currentTime=0)}getDuration(t,e,i){return this.#a.duration-e}onResize(){if(!this.#r)return!1;const t=this.#o.clientWidth/this.#o.clientHeight;return this.#r<t?(this.#a.classList.remove("height"),this.#a.classList.add("width")):(this.#a.classList.remove("width"),this.#a.classList.add("height")),!0}}class C{constructor(t,e,i){this._size=t,this._lis=e,this._time=i;for(let t=0;t<this._size;t+=1)this._lis[t].style.transform="translateX("+(t?100:0)+"%)";setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transition="transform "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.transform=e<=t?"translateX(0%)":"translateX(100%)";await L(1e3*this._time).set()}}class A{constructor(t,e,i){this._size=t,this._lis=e,this._time=i,this._cur=0,this._curPsd=0,this._doing=!1,this._queue=[];const s=this._calcPosition(0,1);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.opacity=1,this._lis[t].style.transform=`translateX(${100*s[t]}%)`}async transition(t,e){if(this._queue.push(((i,s)=>this._doTransition(i,s,t,e))),!this._doing){for(this._doing=!0;this._queue.length;)[this._cur,this._curPsd]=await this._queue.shift()(this._cur,this._curPsd);this._doing=!1}}async _doTransition(t,e,i,s){if(0===s&&t!==i){const e=t<i?i-t:i+this._size-t;s=(i<t?t-i:t+this._size-i)<e?-1:1}let n=this._calcPosition(e,s);for(let t=0;t<this._lis.length;t+=1)this._lis[t].style.transition="",this._lis[t].style.transform=`translateX(${100*n[t]}%)`;await L(100).set();let o=0;1===s&&(o=i-t),-1===s&&(o=t-i),o<0&&(o+=this._size);let l=e;for(let t=0;t<o;t+=1)[n,l]=this._shift(n,l,s,this._time/o,this._getTransition(o,t)),await L(Math.floor(1e3*this._time/o)).set();return[i,l]}_getTransition(t,e){if(1===t)return"ease";if(2===t){if(0===e)return"ease-in";if(1===e)return"ease-out"}return"linear"}_shift(t,e,i,s,n="ease"){const o=this._lis.length;let l=e+i;o-1<l&&(l=0),l<0&&(l=o-1);const a=this._calcPosition(l,i);for(let e=0;e<o;e+=1){const i=1===Math.abs(t[e]-a[e])?`transform ${s}s ${n}`:"";this._lis[e].style.transition=i,this._lis[e].style.transform=`translateX(${100*a[e]}%)`}return[a,l]}_calcPosition(t,e){const i=this._lis.length,s=new Array(i),n=-1!==e?Math.ceil((i-1)/2):Math.floor((i-1)/2),o=i-1-n;for(let e=1;e<=n;e+=1){let n=t+e;i-1<n&&(n-=i),s[n]=e}for(let e=1;e<=o;e+=1){let n=t-e;n<0&&(n+=i),s[n]=-e}return s[t]=0,s}}class E{constructor(t,e,i){this._size=t,this._lis=e,this._time=i;for(let t=0;t<this._size;t+=1)this._lis[t].style.opacity=0===t?1:0;setTimeout((()=>{for(let t=0;t<this._size;t+=1)this._lis[t].style.transition="opacity "+this._time+"s"}),10)}async transition(t,e){for(let e=0;e<this._size;e+=1)this._lis[e].style.opacity=e===t?1:0,this._lis[e].style.pointerEvents=e===t?"auto":"none";await L(1e3*this._time).set()}}var z;function D(){let t=!0;for(const e of _)e.onResize()||(t=!1);return t}(function(){const t=a.classList.contains(l);let e=!1;for(let i=0;i<u.length;i+=1){t&&u[i].classList.add(l);const s=new v(u[i],i,!1);"video"===s.getType&&(e=!0),_.push(s)}switch(y(D),r){case"slide":default:f=new C(m,u,h);break;case"scroll":f=new A(m,u,h);break;case"fade":f=new E(m,u,h)}return e})()&&setTimeout((function t(){D()||setTimeout(t,100)}),100),z=()=>{window.addEventListener("resize",(()=>{for(const t of g)t()}),{passive:!0}),function(t,e,i){new IntersectionObserver((i=>{for(const s of i)t.classList[s.isIntersecting?"add":"remove"](e)}),{rootMargin:`${i}px 0px`}).observe(t),document.addEventListener("visibilitychange",(()=>{if("hidden"!==document.visibilityState){const i=t.getBoundingClientRect(),s=window.innerHeight;(0<i.top&&i.top<s||0<i.bottom&&i.bottom<s)&&t.classList.add(e)}else t.classList.remove(e)}))}(a,n,100),R(0,0),console.log(`Gida Slider - Hero (#${t}): started`),setTimeout((()=>a.classList.add("start")),0)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",z):setTimeout(z,0);let I=0,P=null,T=0,b=null;async function R(t,e){[t,e]=function(t,e){null===t?(m-1<(t=I+e)&&(t=0),t<0&&(t=m-1)):0===e&&(I<t&&(e=1,I-(t-m)<t-I&&(e=-1)),t<I&&(e=-1,t+m-I<I-t&&(e=1)));return[t,e]}(t,e);const i=window.performance.now();if(0!==e&&i-T<1e3*h)return clearTimeout(b),void(b=setTimeout((()=>R(t,e)),1e3*h-(i-T)));T=i;for(const e of _)e.onPreDisplay(t,m);for(const e of _)e.transition(t,m);await f.transition(t,e),p&&p(),I=t,async function(t){for(const e of _)e.display(t,m);if(1===m)return;const e=_[t].getDuration(c,h,d);P&&P.clear();P=L(Math.ceil(1e3*e),q),await P.set()}(t)}async function q(){a.classList.contains(n)&&!a.classList.contains(o)?R(null,1):L(1e3*c,q).set()}const M={move:t=>R(t,2===m?1:0),next:()=>R(I===m-1?0:I+1,1),prev:()=>R(0===I?m-1:I-1,-1),onTransitionEnd:t=>{p=t}};return window.GIDA.sliders[t]=M,M};
//# sourceMappingURL=hero.min.js.map